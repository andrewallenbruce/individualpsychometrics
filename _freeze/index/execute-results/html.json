{
  "hash": "d3e4473c0fd97dabc827772a50087478",
  "result": {
    "markdown": "---\ntitle-block-banner: true\n---\n\n\n# Preface {.unnumbered}\n\nI have ambitious goals for this book, but it is not nearly complete. I have been working on it off and on since 2012. It is accompanied by the R package [psycheval](https://wjschne.github.io/psycheval/) [@R-psycheval], which is also in a preliminary state of development.\n\n\n\n\n::: {.cell .tbl-cap-location-margin layout-align=\"center\" hash='index_cache/html/makesvg_9f226df95af9f6c5353cd9d9f665c780'}\n\n:::\n\n\nMost of the figures and tables for this book were created in R or in $\\LaTeX$. To make the content as accessible and transparent as possible, I have included buttons that will reveal the code used to make each figure or table. For example, the initial setup code used for this book can be seen by clicking the button below:\n\n\n::: {.cell .tbl-cap-location-margin layout-align=\"center\" button_r='true' button_before_r='true' button_after='true' hash='index_cache/html/setupCode_db749bc27678b765a71c764f180882a4'}\n<div class=\"wrap-collapsible\" style=\"margin-top: 1em\">\n<input id=\"collapsible-setupCode\" class=\"toggle\" type=\"checkbox\">\n<label for=\"collapsible-setupCode\" class=\"lbl-toggle\">R Code</label><div class=\"collapsible-content\">\n<div class=\"content-inner\">\n\n```{.r .cell-code}\n# Load packages\nlibrary(extrafont)\nloadfonts(\"win\", quiet = TRUE)\nlibrary(tufte)\nlibrary(knitr)\nlibrary(sn)\nlibrary(fMultivar)\nlibrary(IDPmisc)\nlibrary(psych)\nlibrary(tidyverse)\nlibrary(gganimate)\nlibrary(ggforce)\nlibrary(sjmisc)\nlibrary(WJSmisc)\nlibrary(tippy)\nlibrary(tikzDevice)\nlibrary(patchwork)\nlibrary(qualvar)\nlibrary(modeest)\nlibrary(tinter)\nlibrary(ggfx)\nlibrary(ggtext)\nlibrary(lemon)\nlibrary(signs)\nlibrary(scales)\nlibrary(psycheval)\nlibrary(bezier)\nlibrary(DescTools)\n\n# Set options\noptions(knitr.kable.digits = 2, knitr.kable.na = '')\nknitr::opts_template$set(marginfigure = list(fig.column = \"margin\", fig.cap.location = \"top\", out.width = \"100%\", fig.align = \"left\"),\n                         bodyfigure = list(fig.column = \"body\", fig.cap.location = \"margin\"))\n\n# Default fonts and colors\nbfont = \"Equity Text A Tab\"\nbsize = 16\nmyfills <- c(\"royalblue4\", \"firebrick4\", \"#51315E\")\n\n# Function for converting base size to geom_text size\nggtext_size <- function(base_size, ratio = 0.8) {\n  ratio * base_size / ggplot2:::.pt\n}\n\nbtxt_size = ggtext_size(bsize)\n\n# Default geoms and themes\nggplot2::update_geom_defaults(\"text\",\n                              list(family = bfont, size = btxt_size))\nggplot2::update_geom_defaults(\"label\",\n                              list(\n                                family = bfont,\n                                size = btxt_size,\n                                label.padding = unit(0, \"lines\"),\n                                label.size = 0\n                              ))\n\nggplot2::update_geom_defaults(\"richtext\",\n                              list(family = bfont, size = btxt_size))\n\nggplot2::update_geom_defaults(\"density\", list(fill = myfills[1]))\ngeom_text_fill <- function(...) {\n  geom_label(...,\n             label.padding = unit(0, \"lines\"),\n             label.size = 0)\n}\ntheme_set(theme_minimal(base_size = bsize, base_family = bfont))\n\n\n# font family\nspan_style <- function(x, style = \"font-family:serif\") {\n  paste0('<span style=\\\"',\n         style,\n         '\\\">',\n         x,\n         \"</span>\")\n}\n\n# Probability labels\nprob_label <- function(p,\n                       accuracy = 0.01,\n                       digits = NULL,\n                       max_digits = NULL,\n                       remove_leading_zero = TRUE,\n                       round_zero_one = TRUE) {\n  if (is.null(digits)) {\n    l <- scales::number(p, accuracy = accuracy)\n  } else {\n    sig_digits <- abs(ceiling(log10(p + p / 1000000000)) - digits)\n    sig_digits[p > 0.99] <- abs(ceiling(log10(1 - p[p > 0.99])) - digits + 1)\n    sig_digits[(ceiling(log10(p)) == log10(p)) & (-log10(p) >= digits)] <- sig_digits[ceiling(log10(p)) == log10(p)] - 1\n    sig_digits[is.infinite(sig_digits)] <- 0\n    l <- purrr::map2_chr(p,\n                         sig_digits,\n                         formatC,\n                         format = \"f\",\n                         flag = \"#\")\n\n  }\n  if (remove_leading_zero) l <- sub(\"^-0\",\"-\", sub(\"^0\",\"\", l))\n\n  if (round_zero_one) {\n    l[p == 0] <- \"0\"\n    l[p == 1] <- \"1\"\n    l[p == -1] <- \"-1\"\n  }\n\n  if (!is.null(max_digits)) {\n    if (round_zero_one) {\n      l[round(p, digits = max_digits) == 0] <- \"0\"\n      l[round(p, digits = max_digits) == 1] <- \"1\"\n      l[round(p, digits = max_digits) == -1] <- \"-1\"\n    } else {\n      l[round(p, digits = max_digits) == 0] <- paste0(\".\", paste0(rep(\"0\", max_digits), collapse = \"\"))\n      l[round(p, digits = max_digits) == 1] <- paste0(\"1.\", paste0(rep(\"0\", max_digits), collapse = \"\"))\n      l[round(p, digits = max_digits) == -1] <- paste0(\"-1.\", paste0(rep(\"0\", max_digits), collapse = \"\"))\n    }\n  }\n\n  dim(l) <- dim(p)\n  l\n}\n\n# Set table column width\n# https://github.com/rstudio/bookdown/issues/122#issuecomment-221101375\nhtml_table_width <- function(kable_output, width, tag = \"</caption>\"){\n  width_html <- paste0(\n    paste0('<col width=\"',\n           width,\n           '\">'),\n    collapse = \"\\n\")\n  sub(tag,\n      paste0(tag,\n             \"\\n\",\n             width_html),\n      kable_output)\n}\n\n# Make a matrix with braces\nbmatrix <- function(M, brace = \"bmatrix\", includenames=TRUE) {\n  if (includenames) {\n    M <- cbind(rownames(M),M)\n    M <- rbind(colnames(M), M)\n  }\n  M <-  paste(apply(M,\n                    MARGIN = 1,\n                    FUN = paste0,\n                    collapse = \" & \"),\n              collapse = \"\\\\\\\\\\n\")\n\n\n  if (!is.null(brace)) {\n    M <- paste0(\"\\\\begin{\",brace,\"}\\n\", M, \"\\n\\\\end{\", brace , \"}\")\n    }\n  M\n}\n\n# defword <- function(word,\n#                     note,\n#                     wordclass=\"defword\",\n#                     noteclass = \"aside defword\",\n#                     icon = \"&#8853;\") {\n#   # Adapted from tufte:::marginnote_html\n# \n#   sprintf(\n#     paste0(\n#       \"<span class=\\\"%s\\\">%s</span>\",\n#       \"<span class=\\\"%s\\\">\",\n#       \"<label for=\\\"tufte-mn-\\\" class=\\\"margin-toggle\\\">%s</label>\",\n#       \"<input type=\\\"checkbox\\\" id=\\\"tufte-mn-\\\" class=\\\"margin-toggle\\\">%s\",\n#       \"</span>\"\n#     ),\n#     wordclass,\n#     word,\n#     noteclass,\n#     icon,\n#     note\n#   )\n# }\n\n# Hooks -------\n\n# Enclose collapsible r chunk in  button\nknitr::opts_hooks$set(button_r = function(options) {\n  if (isTRUE(options$button_r)) {\n    options$button_before_r <- TRUE\n    options$button_after <- TRUE\n    options$echo = TRUE; options$eval = FALSE\n  }\n\n  options\n})\n\n# Enclose collapsible latex chunk in  button\nknitr::opts_hooks$set(button_latex = function(options) {\n  if (isTRUE(options$button_latex)) {\n    options$button_before_latex <- TRUE\n    options$button_after <- TRUE\n    options$echo = TRUE; options$eval = FALSE\n  }\n\n  options\n})\n\n# before button for collapsible r chunk\nknit_hooks$set(\n  button_before_r = function(before, options, envir) {\n    if (before) {\n      codetype <- \"R Code\"\n      if (!is.null(options$figlabel)) {\n        codetype <- paste0(codetype, \" for @\", options$figlabel)\n      } \n      return(\n        paste0(\n          '<div class=\"wrap-collapsible\" style=\"margin-top: 1em\">',\n          \"\\n\",\n          '<input id=\"collapsible-',\n          options$label,\n          '\" class=\"toggle\" type=\"checkbox\">',\n          \"\\n\",\n          '<label for=\"collapsible-',\n          options$label,\n          '\" class=\"lbl-toggle\">', codetype,'</label>',\n          '<div class=\"collapsible-content\">',\n          \"\\n\",\n          '<div class=\"content-inner\">'\n        )\n      )\n    }\n  }\n)\n\n# before button for collapsible latex chunk\nknit_hooks$set(\n  button_before_latex = function(before, options, envir) {\n    if (before) {\n      codetype <- \"$\\\\rm\\\\LaTeX~Code$\"\n      if (!is.null(options$figlabel)) {\n        codetype <- paste0(codetype, \" for @\", options$figlabel)\n      } \n      return(\n        paste0(\n          '<div class=\"wrap-collapsible\" style=\"margin-top: 1em\">',\n          \"\\n\",\n          '<input id=\"collapsible-',\n          options$label,\n          '\" class=\"toggle\" type=\"checkbox\">',\n          \"\\n\",\n          '<label for=\"collapsible-',\n          options$label,\n          '\" class=\"lbl-toggle\">',\n          codetype,\n          '</label>',\n          '<div class=\"collapsible-content\">',\n          \"\\n\",\n          '<div class=\"content-inner\">'\n        )\n      )\n    }\n  }\n)\n\n# After button for collapsible chunks\nknit_hooks$set(button_after = function(before, options, envir) {\n  if (!before) return('</div></div></div>')\n})\n```\n\n</div></div></div>\n:::\n\n\nIn addition, all the files and code used to create this book can be found in its [Github repository](https://github.com/wjschne/toolkit).\n\nTo avoid repeated citation, I must note that in preparing this book, I have drawn heavily---and no doubt unconsciously---from many authoritative sources on psychometrics, statistical analysis, and linear algebra [@cohenAppliedMultipleRegression2003;@furrPsychometricsIntroduction2017;@crockerIntroductionClassicalModern2006;@nunnallyPsychometricTheory1967;@raykovIntroductionPsychometricTheory2011;@eatonMultivariateStatisticsVector2007; @strangIntroductionLinearAlgebra2016]. I am also grateful to the many unsung authors at  [Wikipedia](https://www.wikipedia.org/) and [Mathematica](https://www.wolfram.com/mathematica/) who maintain wonderfully comprehensive, up-to-date, and well-referenced documentation of all things mathematical and statistical.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}