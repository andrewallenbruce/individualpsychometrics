{
  "hash": "3687b6112517f27c017446c5f4e04f45",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Distributions\nsubtitle: Discrete\ntoc-title: \"Distributions--Discrete\"\n---\n\n\n\n\n\n\n## Random Variables\n\nBecause we first learn about variables in an algebra class, we tend to think of variables as having values that can be solved for---if we have enough information about them. If I say that $x$ is a variable and that $x+6=8$, we can use algebra to find that $x$ must equal 2.\n\n[Random variables]{.defword title=\"**Random variables** have values that are determined by a random process.\"} are not like algebraic variables. Random variables simply take on values because of some random process. If we say that the outcome of a throw of a six-sided die is a random variable, there is nothing to \"solve for.\" There is no equation that determines the value of the die. Instead, it is determined by chance and the physical constraints of the die. That is, the outcome must be one of the numbers printed on the die, and the six numbers are equally likely to occur. This illustrates an important point. The word *random* here does not mean \"anything can happen.\" On a six-sided die, you will never roll a 7, 3.5, $\\sqrt{\\pi}$, &minus;36,000, or any other number that does not appear on the six sides of the die. Random variables have outcomes that are subject to random processes, but those random processes *do*  have constraints on them such that some outcomes are more likely than others---and some outcomes never occur at all. \n\n\n\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![Rolling a six-sided die is a process that creates a randomly ordered series of integers from 1 to 6.](distributions_files/figure-html/fig-randomvariable-1.gif){#fig-randomvariable fig-align='left' width=100}\n:::\n:::\n\n\n\n\nWhen we say that the throw of a six-sided die is a random variable, we are not talking about any particular throw of a particular die but, in a sense, *every* throw (that has ever happened or ever could happen) of *every* die (that has ever existed or could exist). Imagine an immense, roaring, neverending, cascading flow of dice falling from the sky. As each die lands and disappears, a giant scoreboard nearby records the relative frequencies of ones, twos, threes, fours, fives, and sixes. That's a random variable.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-randomvariable\n\n```{.r .cell-code}\n# Function to make dice\nmakedice <- function(i, id, add_blank = TRUE) {\n  x = switch(\n           i,\n           `1` = 0,\n           `2` = c(-1, 1),\n           `3` = c(-1, 1, 0),\n           `4` = c(-1, 1, -1, 1),\n           `5` = c(-1, 1, -1, 1, 0),\n           `6` = c(-1, 1, -1, 1, -1, 1)\n         )\n  y = switch(\n           i,\n           `1` = 0,\n           `2` = c(1,-1),\n           `3` = c(1,-1, 0),\n           `4` = c(1,-1,-1, 1),\n           `5` = c(1,-1,-1, 1, 0),\n           `6` = c(1,-1,-1, 1, 0, 0))\n  \n  d <- tibble(id = id * 1,\n              i = i,\n              x = x,\n              y = y)\n  \n  if (add_blank) {\n    d <- d %>%\n      add_case(id = id + 0.5,\n               i = 0,\n               x = NA,\n               y = NA)\n  }\n  d\n}\n\n# Number of throws\nk <- 50\n\n# Dot positions\nd <- map2_df(sample(1:6,k, replace = T), 1:k, makedice)  \n\n# Plot\np <- ggplot(d) +\n  geom_point(pch = 16, size = 50, aes(x, y))  +\n  ob_ellipse(\n    a = 1.85,\n    b = 1.85,\n    m1 = 12,\n    linewidth = 4\n  ) +\n  coord_equal() +\n  theme_void() +\n  theme(legend.position = \"none\") +\n  transition_manual(id) \n\n# Render animation\np_gif <- animate(\n  p,\n  fps = 1,\n  device = \"svg\",\n  renderer = magick_renderer(),\n  width = 8,\n  height = 8\n)\np_gif\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n## Sets\n\nA [set]{.defword title=\"A **set** is a collection of distinct objects.\"} refers to a collection of objects. Each distinct object in a set is an [element]{.defword title=\"An **element** is a distinct member of a set.\"}. \n\n### Discrete Sets\n\nTo show that a list of discrete elements is a [discrete set]{.defword title=\"A **discrete set** has numbers that are isolated, meaning that each number has a range in which it is the only number in the overall set.\"}, we can use curly braces. For example, the set of positive single-digit even numbers is $\\{2, 4, 6, 8\\}$. With large sets with repeating patterns, it is convenient to use an ellipsis (\"...\"), the punctuation mark signifying an omission or pause. For example, rather than listing every two-digit positive even number, we can show the pattern like so: \n\n$$\\{10, 12, 14,\\ldots, 98\\}$$\n\nIf we want the pattern to repeat forever, we can set an ellipsis on the left, right, or both sides. The set of odd integers extends to infinity in both directions:\n\n$$\\{\\ldots, -5, -3, -1, 1, 3, 5, \\ldots\\}$$\n\n\n### Interval Sets\n\nWith continuous variables, we can define sets in terms of [intervals]{.defword title=\"**Intervals** are a continous range of numbers.\"}. Whereas the discrete set $\\{0,1\\}$ refers just to the numbers 0 and 1, the interval set $(0,1)$ refers to all the numbers between 0 and 1. \n\n\n\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![Interval Notation](distributions_files/figure-html/fig-intervalnotation-1.png){#fig-intervalnotation fig-align='left' width=300}\n:::\n:::\n\n\n\n\n\nAs shown in @fig-intervalnotation, some intervals include their endpoints and others do not. Intervals noted with square brackets include their endpoints and intervals written with parentheses exclude them. Some intervals extend to positive or negative infinity: $(-\\infty,5]$ and $(-8,+\\infty)$. Use a parenthesis with infinity instead of a square bracket because infinity is not a specific number that can be included in an interval.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-intervalnotation\n\n```{.r .cell-code}\n# Interval notation\ntibble(lb = 1L,\n       ub = 5L,\n       y = 1:4,\n       meaning = c(\"includes 1 and 5\",\n                   \"excludes 1 and 5\",\n                   \"includes 1 but not 5\",\n                   \"includes 5 but not 1\"),\n       l_bracket = c(\"[\", \"(\", \"[\", \"(\"),\n       u_bracket = c(\"]\", \")\", \")\", \"]\")) %>% \n  mutate(Interval = paste0(l_bracket, lb, \",\", ub, u_bracket) %>% \n           fct_inorder() %>% \n           fct_rev,\n         l_fill = ifelse(l_bracket == \"[\", myfills[1], \"white\"),\n         u_fill = ifelse(u_bracket == \"]\", myfills[1], \"white\")) %>% \n  ggplot(aes(lb, Interval)) + \n  geom_segment(aes(xend = ub, yend = Interval), \n               linewidth = 2, \n               color = myfills[1]) +\n  geom_point(aes(fill = l_fill), \n             size = 5, \n             pch = 21, \n             stroke = 2, color = myfills[1]) + \n  geom_point(aes(fill = u_fill, x = ub), \n             size = 5, \n             pch = 21, \n             stroke = 2, \n             color = myfills[1]) +\n  geom_label(aes(label = paste(Interval, meaning), x = 3), \n             vjust = -.75, \n             label.padding = unit(0,\"lines\"), \n             label.size = 0, \n             family = bfont, \n             size = ggtext_size(27)) +\n  scale_fill_identity() +\n  scale_y_discrete(NULL, expand = expansion(c(0.08, 0.25))) +\n  scale_x_continuous(NULL, minor_breaks = NULL) +\n  theme_minimal(base_size = 27, \n                base_family = bfont) + \n  theme(axis.text.y = element_blank(), \n        panel.grid.major = element_blank(),\n        axis.line.x = element_line(linewidth = .5),\n        axis.ticks.x = element_line(linewidth = .25), \n        plot.margin = margin())\n```\n\n\n:::\n:::\n\n\n\n\n\n## Sample Spaces {#sec:SampleSpace}\n\nThe set of all possible outcomes of a random variable is the [sample space]{.defword title=\"A **sample space** is the set of all possible values that a random variable can assume.\"}. Continuing with our example, the sample space of a single throw of a six-sided die is the set $\\{1,2,3,4,5,6\\}$. *Sample space* is a curious term. Why *sample* and why *space*? With random variables, [populations]{.defword title=\"A **population** consists of all entities under consideration.\"} are infinitely large, at least theoretically. Random variables just keep spitting out numbers forever! So any time we actually observe numbers generated by a random variable, we are always observing a [sample]{.defword title=\"A **sample** is a subset of a population.\"}; actual infinities cannot be observed in their entirety. A *space* is a set that has mathematical structure. Most random variables generate either integers or real numbers, both of which are structured in many ways (e.g., order).\n\nUnlike distributions having to do with dice, many distributions have a sample space with an infinite number of elements. Interestingly, there are two kinds of infinity we can consider. A distribution's sample space might be the set of whole numbers: $\\{0,1,2,...\\}$, which extends to positive infinity. The sample space of all integers extends to infinity in both directions: $\\{...-2,-1,0,1,2,...\\}$.\n\nThe sample space of continuous variables is infinitely large for another reason. Between any two points in a continuous distribution, there is an infinite number of other points. For example, in the beta distribution, the sample space consists of all real numbers between 0 and 1: $(0,1)$. Many continuous distributions have sample spaces that involve both kinds of infinity. For example, the sample space of the [normal distribution](#sec-normal) consists of all real numbers from negative infinity to positive infinity: $(-\\infty, +\\infty)$.\n\n## Probability Distributions {#sec:ProbabilityDistribution}\n\n\n\nEach element of a random variable's sample space occurs with a particular probability. When we list the probabilities of each possible outcome, we have specified the variable's [probability distribution]{.defword title=\"In a **probability distribution**, there is an assignment of a probability to each possible element in a variable's sample space.\"}. In other words, if we know the probability distribution of a variable, we know how probable each outcome is. In the case of a throw of a single die, each outcome is equally likely (@fig-dicepmf).\n\n\n\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![The probability distribution of a throw of a single die](distributions_files/figure-html/fig-dicepmf-1.png){#fig-dicepmf fig-align='left' width=250}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-dicepmf\n\n```{.r .cell-code}\nposition_dice <- function(i, r = 1.85, space = 1) {\n  # Height of dice center\n  y0 <- (6 - i) * (2 * r + space)\n  \n  # Dice dots\n  p <- makedice(i, i, add_blank = F) %>%\n    mutate(y = y + y0) %>%\n    ob_point() %>%\n    ob_circle(radius = .4,\n              fill = \"black\",\n              color = NA)\n  \n  # Dice outlines\n  e <- ob_ellipse(\n    ob_point(0, y0),\n    a = r,\n    b = r,\n    m1  = 12,\n    linewidth = .75\n  )\n  \n  # Probability point\n  p_pr <- e@center + ob_point(13, 0)\n  \n  # Probability label\n  pr <- ob_label(\n    label = \"&frac16;\", \n    p = p_pr, \n    size = 32, \n    family = \"serif\")\n  \n  # Arrow connectors\n  a <- connect(\n    e,\n    p_pr,\n    linewidth = 2,\n    resect_fins = 3,\n    resect_head = 6,\n    length_head = 4,\n    color = \"gray70\"\n  )\n  \n  # bind list\n  c(p, e, pr, a)\n}\n\n# shape list\nsl <- map_ob(1:6, position_dice)\n\n# Sample space label\nss_label <- ob_label(\n  label = \"Sample Space\", \n  p = sl[[\"ob_ellipse\"]]@bounding_box@north + \n           ob_point(0, 2),\n  size = 24)\n\n# Probability label\npr_label <- ob_label(\n    label = \"Probability\", \n    ss_label@p %-|% sl[[\"ob_label\"]]@p@bounding_box@north, \n    size = 24\n    )\n\n# Plot\nggdiagram(bfont) +\n  sl +\n  ss_label + \n  pr_label\n```\n\n\n:::\n:::\n\n\n\n\nThere is an infinite variety of probability distributions, but a small subset of them have been given names. Now, one can manage one's affairs quite well without ever knowing what a Bernoulli distribution is, or what a $\\chi{^2}$ distribution is, or even what a normal distribution is. However, sometimes life is a little easier if we have names for useful things that occur often. Most of the distributions with names are not really single distributions, but families of distributions. The various members of a family are unique but they are united by the fact that their probability distributions are generated by a particular mathematical function (more on that later). In such cases, the probability distribution is often represented by a graph in which the sample space is on the $X$-axis and the associated probabilities are on the $Y$-axis. In @fig-pdfIllustration, 16 probability distributions that might be interesting and useful to clinicians are illustrated. Keep in mind that what are pictured are only particular members of the families listed; some family members look quite different from what is shown in @fig-pdfIllustration.\n\n\n\n\n::: {.cell .fig-column-page-right .fig-cap-location-top .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![A gallery of useful distributions](images/pdfIllustration.svg){#fig-pdfIllustration fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-pdfIllustration\n\n```{.r .cell-code}\n# A gallery of useful distributions\n# Run output file pdfIllustration.tex in LaTeX\n# pdflatex --enable-write18 --extra-mem-bot=10000000 --synctex=1 pdfIllustration.tex\ntikzpackages <- paste(\n  \"\\\\usepackage{tikz}\",\n  \"\\\\usepackage{amsmath}\",\n  \"\\\\usepackage[active,tightpage,psfixbb]{preview}\",\n  \"\\\\PreviewEnvironment{pgfpicture}\",\n  collapse = \"\\n\"\n)\n\ntikzDevice::tikz('pdfIllustration.tex',\n                 standAlone = TRUE, \n                 packages = tikzpackages, \n                 width = 11, \n                 height = 11)\npar(\n  mar = c(1.75, 1.3, 1.75, 0),\n  mfrow = c(4, 4),\n  las = 1,\n  xpd = TRUE,\n  family = 'serif',\n  pty = \"s\",\n  mgp = c(2, 0.5, 0),\n  tcl = -0.3,\n  cex = 1.35\n)\n\n# Bernoulli\nplot(\n  c(0.2, 0.8) ~ seq(0, 1),\n  type = \"b\",\n  ylim = c(0, 1),\n  bty = \"n\",\n  col = myfills[1],\n  lwd = 1,\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Bernoulli\",\n  lty = 3,\n  pch = 19,\n  xaxp = c(0, 1, 1),\n  xlim = c(-0.1, 1)\n)\ntext(x = .7, y = .8, \"$p=0.8$\")\n\n# Binomial\nplot(\n  dbinom(seq(0, 5), 5, 0.2) ~ seq(0, 5),\n  type = \"b\",\n  xlim = c(-0.1, 5),\n  bty = \"n\",\n  col = myfills[1],\n  lwd = 1,\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Binomial\",\n  lty = 3,\n  pch = 19\n)\ntext(\n  x = c(3.5, 3.5),\n  y = c(.35, .25),\n  c(\"$p=0.2$\", \"$n=5$\"),\n  adj = 0\n)\n\n# Poisson\nplot(\n  dpois(0:10, 3) ~ seq(0, 10),\n  type = \"b\",\n  xlim = c(-0.1, 10),\n  bty = \"n\",\n  col = myfills[1],\n  lwd = 1,\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Poisson\",\n  lty = 3,\n  pch = 19\n)\ntext(x = 7, y = .15, r\"($\\lambda=3$)\")\n\n# Geometric\nplot(\n  dgeom(0:4, prob = 0.8) ~ seq(0, 4),\n  type = \"b\",\n  ylim = c(0, .8),\n  xlim = c(-0.1, 4),\n  bty = \"n\",\n  col = myfills[1],\n  lwd = 1,\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Geometric\",\n  lty = 3,\n  pch = 19\n)\ntext(x = 2, y = .6, \"$p=0.8$\")\n\n# Discrete Uniform\nplot(\n  rep(1 / 4, 4) ~ seq(1, 4),\n  type = \"b\",\n  ylim = c(0, 1),\n  xlim = c(0, 5),\n  bty = \"n\",\n  col = myfills[1],\n  lwd = 1,\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Discrete Uniform\",\n  lty = 3,\n  pch = 19\n)\ntext(\n  x = c(1, 4),\n  y = c(.5, .5),\n  c(\"$a=1$\", \"$b=4$\"),\n  adj = 0.5\n)\n\n# Continuous\nplot(\n  c(0, 1 / 3, 1 / 3, 0) ~ c(1, 1, 4, 4),\n  type = \"n\",\n  ylim = c(0, 1),\n  xlim = c(0, 5),\n  bty = \"n\",\n  col = myfills[1],\n  lwd = 2,\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Continuous Uniform\"\n)\npolygon(\n  c(1, 1, 4, 4),\n  c(0, 1 / 3, 1 / 3, 0),\n  col = myfills[1],\n  xpd = FALSE,\n  border = NA\n)\ntext(\n  x = c(1, 4),\n  y = c(.5, .5),\n  c(\"$a=1$\", \"$b=4$\"),\n  adj = 0.5\n)\n\n# Normal\nx <- seq(-4, 4, 0.02)\nplot(\n  dnorm(x) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Normal\",\n  lwd = 2,\n  bty = \"n\",\n  axes = F\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, dnorm(x), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = FALSE,\n  border = NA\n)\naxis(2)\n\ntext(\n  x = c(-1.5, -1.5),\n  y = c(.35, .25),\n  c(\"$\\\\mu=0$\", \"$\\\\sigma^2=1$\"),\n  adj = 1\n)\n\n\ncenter_neg <- function(x) {\n  signs <- sign(x)\n  paste0(ifelse(signs < 0,\"$\",\"\"), x, ifelse(signs < 0,\"\\\\phantom{-}$\",\"\"))\n}\n\nall_tick_labels <- function(side = 1, at, labels = at) {\n  axis(side, labels = rep(\"\",length(at)), at = at)\nfor (i in 1:length(at)) {\n  axis(side, \n       at = at[i], \n       labels = labels[i],\n       tick = F)\n  }\n}\naxis_ticks <- seq(-4,4,2)\naxis_labs <- center_neg(axis_ticks)\nall_tick_labels(1, at = axis_ticks, labels = axis_labs)\n\n\n# Student t\nx <- seq(-6, 6, 0.02)\nplot(\n  dt(x, 2) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Student's $\\\\boldsymbol{t}$\",\n  lwd = 2,\n  bty = \"n\",\n  ylim = c(0, 0.4),\n  axes = F\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, dt(x, 2), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = FALSE,\n  border = NA\n)\ntext(x = 3, y = .3, \"$\\\\nu=2$\")\naxis(2)\naxis_ticks <- seq(-6,6,2)\naxis_labs <- center_neg(axis_ticks)\nall_tick_labels(1, at = axis_ticks, labels = axis_labs)\n\n# Chi-Square\nx <- seq(0, 40, 0.05)\nplot(\n  dchisq(x, 13) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"$\\\\boldsymbol{\\\\chi^2}$\",\n  lwd = 2,\n  bty = \"n\",\n  ylim = c(0, 0.1)\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, dchisq(x, 13), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = FALSE,\n  border = NA\n)\ntext(x = 20, y = .08, \"$k=2$\", adj = 0)\n\n# F\nx <- seq(0, 6, 0.01)\nplot(\n  df(x, 3, 120) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"$\\\\boldsymbol{F}$\",\n  lwd = 2,\n  bty = \"n\",\n  ylim = c(0, 0.8)\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, df(x, 3, 120), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = TRUE,\n  border = NA\n)\ntext(\n  x = c(2, 2),\n  y = c(.6, .4),\n  c(\"$d_1=3$\", \"$d_2=120$\"),\n  adj = 0\n)\n\n# Weibull\nx <- seq(6.5, 11.5, 0.01)\nplot(\n  dweibull(x, 20, 10) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Weibull\",\n  lwd = 2,\n  bty = \"n\",\n  ylim = c(0, 0.8)\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, dweibull(x, 20, 10), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = TRUE,\n  border = NA\n)\ntext(\n  x = c(7, 7),\n  y = c(.6, .4),\n  c(\"$k=20$\", \"$\\\\lambda=10$\"),\n  adj = 0\n)\n\n# Beta\nx <- seq(0, 1, 0.01)\nplot(\n  dbeta(x, 2, 2.5) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Beta\",\n  lwd = 2,\n  bty = \"n\",\n  ylim = c(0, 2),\n  xaxp = c(0, 1, 1)\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, dbeta(x, 2, 2.5), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = TRUE,\n  border = NA\n)\ntext(\n  x = c(0.75, 0.75),\n  y = c(1.75, 1.25),\n  c(\"$\\\\alpha=2$\", \"$\\\\beta=2.5$\"),\n  adj = 0\n)\n\n# Log Normal\nx <- c(seq(0, .999, 0.001), seq(1, 15, .05))\nplot(\n  dlnorm(x, 2, .5) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Log Normal\",\n  lwd = 2,\n  bty = \"n\",\n  ylim = c(0, 0.4)\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, dlnorm(x, 1, 0.5), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = TRUE,\n  border = NA\n)\ntext(\n  x = c(7, 7),\n  y = c(.3, .2),\n  c(\"$\\\\mu=2$\", \"$\\\\sigma=0.5$\"),\n  adj = 0\n)\n\n\n# Skew Normal\nx <- seq(-4, 4, 0.01)\nplot(\n  sn::dsn(x, 2, 2.5) ~ x,\n  type = \"n\",\n  col = myfills[1],\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Skew Normal\",\n  lwd = 2,\n  bty = \"n\",\n  ylim = c(0, 0.5),\n  axes = F\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, sn::dsn(\n    x,\n    xi = 1,\n    omega = 1.5,\n    alpha = -4\n  ), 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = TRUE,\n  border = NA\n)\ntext(\n  x = c(-3.9, -3.9, -3.9),\n  y = c(.45, .35, .25),\n  c(\"$\\\\xi=1$\", \"$\\\\omega=1.5$\", \"$\\\\alpha=-4$\"),\n  adj = 0\n)\n\naxis(2)\naxis_ticks <- seq(-4,4,2)\naxis_labs <- center_neg(axis_ticks)\nall_tick_labels(1, at = axis_ticks, labels =axis_labs)\n\n# Normal Mixture\nx <- seq(-4, 4, 0.01)\ny <- (dnorm(x, -2, 0.5) * .25 + dnorm(x))\nplot(\n  y ~ x,\n  type = \"n\",\n  col = \"violet\",\n  xlab = \"\",\n  ylab = \"\",\n  main = \"Normal Mixture\",\n  lwd = 4,\n  bty = \"n\",\n  ylim = c(0, 0.5),\n  axes = F\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, y, 0),\n  col = myfills[1],\n  lwd = 1,\n  xpd = TRUE,\n  border = NA\n)\npolygon(\n  c(min(x), x, max(x)),\n  c(0, dnorm(x, -2, 0.5) * .25, 0),\n  col = myfills[2],\n  lwd = 1,\n  xpd = TRUE,\n  border = NA\n)\ntext(\n  x = c(-0.85, -0.85),\n  y = c(.45, .35),\n  c(\"$\\\\mu_1=-2$\", \"$\\\\sigma_1^2=0.5$\"),\n  adj = 1\n)\ntext(\n  x = c(3.5, 3.5),\n  y = c(.45, .35),\n  c(\"$\\\\mu_2=0$\", \"$\\\\sigma_2^2=1$\"),\n  adj = 1\n)\naxis(2)\naxis_ticks <- seq(-4,4,2)\naxis_labs <- center_neg(axis_ticks)\nall_tick_labels(1, at = axis_ticks, labels =axis_labs)\n# Bivariate Normal\n\nx = seq(-4, 4, 0.1)\nX = fMultivar::grid2d(x)\nz = fMultivar::dnorm2d(X$x, X$y, rho = 0.6)\nZ = list(x = x,\n         y = x,\n         z = matrix(z, ncol = length(x)))\npersp(\n  Z,\n  theta = 20,\n  phi = 25,\n  col = \"royalblue1\",\n  xlab = \"\\nX\",\n  ylab = \"\\nY\",\n  zlab = \"\",\n  zlim = c(0, .20),\n  border = NA,\n  expand = .7,\n  box = FALSE,\n  ticktype = \"simple\",\n  ltheta = 0,\n  shade = 0.5,\n  main = \"Bivariate Normal\",\n  lwd = 0.5\n)\ntext(c(-.11, .32), c(-.42, -.25), c(\"X\", \"Y\"))\ntext(0, 0.25, \"$\\\\rho_{XY}=0.6$\")\ndev.off()\n```\n\n\n:::\n:::\n\n\n\n\n## Discrete Distrubitions\n\nThe sample spaces in discrete distributions are discrete sets. Thus, in the x-axis of the probability distributions, you will see isolated numbers with gaps between each number (e.g., integers). \n\n### Discrete Uniform Distributions {#sec:DiscreteUniform}\n\nThe throw of a single die is a member of a family of distributions called the [discrete uniform distribution]{.defword title=\"A **discrete uniform distribution** is a family of random variable distributions in which the sample space is an evenly spaced sequence of numbers, each of which is equally likely to occur.\"}. It is \"discrete\" because the elements in the sample space are countable, with evenly spaced gaps between them. For example, there might be a sequence of 8, 9, 10, and 11 in the sample space, but there are no numbers in between. It is \"uniform\" because all outcomes are equally likely. With dice, the numbers range from a lower bound of 1 to an upper bound of 6. In the family of discrete uniform distributions, the lower and upper bounds are typically integers, mostly likely starting with 1. However, any real number $a$ can be the lower bound and the spacing $k$ between numbers can be any positive real number. For the sake of simplicity and convenience, I will assume that the discrete uniform distribution refers to consecutive integers ranging from a lower bound of $a$ and an upper bound of $b$. \n\nThis kind of discrete uniform distribution has a number of characteristics listed in @tbl-uniformfeatures. I will explain each of them in the sections that follow. As we go, I will also explain the mathematical notation. For example, $a \\in \\{\\ldots,-1,0,1,\\ldots\\}$ means that $a$ is an integer because $\\in$ means *is a member of* and $\\{\\ldots,-1,0,1,\\ldots\\}$ is the set of all integers.^[**Notation note**: Sometimes the set of all integers is referred to with the symbol $\\mathbb{Z}.$] $x \\in \\{a,a+1,\\ldots,b\\}$ means that the each member of the sample space $x$ is a member of the set of integers that include $a$, $b$, and all the integers between $a$ and $b$. The notation for the [probability mass function](#sec:pmf) and the [cumuluative distribution function](#sec:CumDist) function will be explained later in this chapter.\n\n\n\n\n\n::: {#tbl-uniformfeatures .cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" tbl-cap='Features of Discrete Uniform Distributions'}\n::: {.cell-output-display}\n\n\n|Feature                          |Symbol                                |\n|:--------------------------------|:-------------------------------------|\n|Lower Bound                      |$a \\in \\{\\ldots,-1,0,1,\\ldots\\}$      |\n|Upper Bound                      |$b \\in \\{a + 1, a + 2,  \\ldots\\}$     |\n|Sample Space                     |$x \\in\\{a, a + 1,\\ldots,b\\}$          |\n|Number of points                 |$n=b-a+1$                             |\n|Mean                             |$\\mu=\\frac{a+b}{2}$                   |\n|Variance                         |$\\sigma^2=\\frac{n^2-1}{12}$           |\n|Skewness                         |$\\gamma_1=0$                          |\n|Kurtosis                         |$\\gamma_2=-\\frac{6(n^2+1)}{5(n^2-1)}$ |\n|Probability Mass Function        |$f_X(x;a,b)=\\frac{1}{n}$              |\n|Cumulative Distribution Function |$F_X(x;a,b)=\\frac{x-a+1}{n}$          |\n\n\n:::\n:::\n\n\n\n\n### Parameters of Random Variables \n\nThe lower bound $a$ and the upper bound $b$ are the discrete uniform distribution's [parameters]{.defword title=\"A **parameter** is a defining feature of a random variable's probability distribution.\"}. The word *parameter* has many meanings, but here it refers to a characteristic of a distribution family that helps us identify precisely which member of the family we are talking about. Most distribution families have one, two, or three parameters. \n\nIf you have taken an algebra class, you have seen parameters before, though the word *parameter* may not have been used. Think about the formula of a line:\n\n$$\ny=mx+b\n$$\n\n\nBoth $x$ and $y$ are variables, but what are $m$ and $b$? Well, you probably remember that $m$ is the slope of the line and that $b$ is the $y$-intercept. If we know the slope and the intercept of a line, we know exactly which line we are talking about. No additional information is needed to graph the line. Therefore, $m$ and $b$ are the line's *parameters*, because they uniquely identify the line.^[What about other mathematical functions? Do they have parameters? Yes! Most do! For example, in the equation for a parabola $(y=ax^2+bx+c)$, $a$, $b$, and $c$ determine its precise shape.] All lines have a lot in common but there is an infinite variety of lines because the parameters, the slope and the intercept, can take on the value of any real number. Each unique combination of parameter values (slope and intercept) will produce a unique line. So it is with probability distribution families. All family members are alike in many ways, but they also differ because their differing parameters alter the shape of the distributions.\n\nThe discrete uniform distribution (i.e., the typical variety consisting of consecutive integers) is defined by the lower and upper bound. Once we know the lower bound and the upper bound, we know exactly which distribution we are talking about.^[If we allow the lower bound to be any real number and the spacing to be any positive real number, the discrete uniform distribution can be specified by three parameters: the lower bound $a$, the spacing between numbers $k$ $(k>0)$, and the number of points $n$ $(n>1)$. The upper bound $b$ of such a distribution would be $b=a+k(n-1)$] Not all distributions are defined by their lower and upper bounds. Indeed, many distribution families are unbounded on one or both sides. Therefore, other features are used to characterize the distributions, such as the population mean $(\\mu)$.\n\n### Probability Mass Functions {#sec:pmf}\n\nMany distribution families are united by the fact that their probability distributions are generated by a particular mathematical function. For discrete distributions, those functions are called [probability mass functions]{.defword title=\"A **probability mass function** is a mathematical expression that gives the probability that a discrete random variable will equal a particular element of the variable's sample space.\"}. In general, a mathematical function is an expression that takes one or more constants (i.e., parameters) and one or more input variables, which are then transformed according to some sort of rule to yield a single number.\n\nA probability mass function transforms a random variable's sample space elements into probabilities. In @fig-dicepmf, the probability mass function can be thought of as the arrows between the sample space and the probabilities. That is, the probability mass function is the thing that was done to the sample space elements to calculate the probabilities. In @fig-dicepmf, each outcome of a throw of the the die was mapped onto a probability of &frac16;. Why &frac16;, and not some other number? The probability mass function of the discrete uniform distribution tells us the answer. \n\nThe probability mass function of the discrete uniform distribution is fairly simple but the notation can be intimidating at first (@fig-pmf). By convention, a single random variable is denoted by a capital letter $X$. Any particular value of $X$ in its sample space is represented by a lowercase $x$. In other words, $X$ represents the variable in its totality whereas $x$ is merely one value that $X$ can take on. Confusing? Yes, statisticians work very hard to confuse us---and most of the time they succeed! \n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![Probability mass functions tell us how probable each sample space element is. That is, they are functions that convert samples spaces $(\\boldsymbol{x})$ into probabilities $(\\boldsymbol{p})$ according to specific parameters $(\\boldsymbol{\\theta}).$](distributions_files/figure-html/fig-pmf-1.png){#fig-pmf fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-pmf\n\n```{.r .cell-code}\nwhitespace <- function(\n    size = 10, \n    text = \".\", \n    color = \"white\") {\n  paste0(\"<span style='color:\",\n         color,\n         \"; font-size:\",\n         size, \n         \"pt;'>\",\n         text,\n         \"</span>\")\n}\n\nxr <- ob_rectangle(\n  center = ob_point(0, 0), \n  width = 1, \n  height = 1/4, \n  label = ob_label(\n    label = \"***x*** = *x*~1~, *x*~2~, *x*~3~, …, *x*~*n*~\", \n    size = 20),\n  corner_radius = unit(5, \"pt\"))\n\nss_label <- ob_label(\"**Sample Space**\", \n                     xr@north, vjust = -.2, \n                     size = 24)\n\npr <- ob_rectangle(\n  center = ob_point(2, 0), \n  width = 1, \n  height = 1/4, \n  family = \"serif\",\n  label = ob_label(\n    \"***p*** = *p*~1~, *p*~2~, *p*~3~, …, *p*~*n*~\", \n    size = 20),\n  corner_radius = unit(5, \"pt\"))\n\np_label <- ob_label(\n  label = \"**Probabilities**\", \n  p = pr@north, \n  vjust = -.2, \n  size = 24)\n\npmf_label <- ob_label(\n  label = \"**Mass Function**\", \n  p = midpoint(ss_label@p, p_label@p), \n  vjust = -.2, \n  size = 24,\n  color = myfills[1])\n\nth <- \"<span style='font-family: serif'>&theta;<span>\"\n\nthetar <- ob_rectangle(\n  pmf_label@p + ob_point(0,-.8),  \n  width = 1, \n  height = 1/4, \n  label = ob_label(\n    paste0(\n      \"***\",\n      th,\n      \"*** = \",\n      paste0(\n        \"*\", \n        th, \n        \"*~\", \n        1:3, \n        \"~, \", \n        collapse = \"\"),\n      \" …, *\",\n      th,\n      \"*~*n*~\"), \n    size = 20,\n    vjust = .55),\n  corner_radius = unit(5, \"pt\"))\n\nth_label <- ob_label(\n  label = \"**Parameters**\", \n  p = thetar@north, \n  vjust = -.2, \n  size = 24)\n\nfx_label <-  ob_label(\n    \"***f***~*X*~\",\n    midpoint(xr@center, pr@center),\n    color = \"white\",\n    fill = NA,\n    size = 18,\n    vjust = .55\n  ) \n\nggdiagram(font_family = bfont) +\n  xr +\n  ss_label +\n  pr +\n  p_label +\n  pmf_label +\n  ob_label(\n    \"**Probability**\",\n    pmf_label@p,\n    vjust = -1.15,\n    size = 24,\n    color = myfills[1]\n  ) +\n  connect(\n    xr,\n    pr,\n    resect = 7.5,\n    linewidth = 15,\n    length_head = .85,\n    arrow_head = ggarrow::arrow_head_wings(\n      offset = 45, \n      inset = 45),\n    color = myfills[1]\n  ) +\n  fx_label + \n  thetar + \n  th_label +\n  connect(th_label@p, \n          fx_label@p, \n          resect_head = 9, \n          resect_fins = 14, \n          linewidth = 1.25, \n          length_head = 4) +\n  ob_label(\n    paste0(\n      \"*f<sub>X\",\n      whitespace(),\n      \"</sub>*(\",\n      whitespace(1),\n      \"***x***; ***\", \n      th, \n      \"***\",\n      whitespace(2),\n      \") = ***p***\"),\n    p = pmf_label@p + ob_point(0,.5), \n    size = 20)\n```\n\n\n:::\n:::\n\n\n\n\n\n\nThe probability mass function of random variable $X$ is denoted by $f_X(x)$. This looks strange at first. It means, \"When random variable $X$ generates a number, what is the probability that the outcome will be a particular value $x$?\" That is, $f_X(x)=P(X=x)$, where $P$ means \"What is the probability that...?\" Thus, $P(X=x)$ reads, \"What is the probability that random variable $X$ will generate a number equal to a particular value $x$?\" So, $f_X(7)$ reads, \"When random variable $X$ generates a number, what is the probability that the outcome will be 7?\"\n\nMost probability mass functions also have parameters, which are listed after a semi-colon. In the case of the discrete uniform distribution consisting of consecutive integers, the lower and upper bounds $a$ and $b$ are included in the function's notation like so: $f_X(x;a,b)$. This reads, \"For random variable $X$ with parameters $a$ and $b$, what is the probability that the outcome will be $x$?\" Some parameters can be derived from other parameters, as was the case with the number of points $n$ in the sample space of a discrete uniform distribution: $n=b-a+1$. The probability for each outcome in the sample space is the same and there are $n$ possible outcomes. Therefore, the probability associated with each outcome is $\\frac{1}{n}$.\n\nPutting all of this together, if $a$ and $b$ are integers and $a<b$, for all $n$ integers $x$ between $a$ and $b$, inclusive:\n\n$$\n\\begin{aligned}\nf_X\\left(x;a,b\\right)&=\\frac{1}{b-a+1}\\\\[2ex]\n&=\\frac{1}{n}\n\\end{aligned}\n$$\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|Symbol |Meaning                                                |\n|:------|:------------------------------------------------------|\n|$X$    |A random variable with a discrete uniform distribution |\n|$f_X$  |The probability mass function of $X$                   |\n|$x$    |Any particular member of the sample space of $X$       |\n|$a$    |The lower bound of the sample space                    |\n|$b$    |The upper bound of the sample space                    |\n|$n$    |$b-a+1$ (The number of points in the sample space)     |\n\n\n:::\n:::\n\n\n\n\n\nYou might notice that $x$ is not needed to calculate the probability. Why? Because this is a *uniform* distribution. No matter which sample space element $x$ we are talking about, the probability associated with it is always the same. In distributions that are not uniform, the position of $x$ matters and thus influences the probability of its occurrence.\n\n### Cumulative Distribution Functions {#sec:CumDist}\n\nThe [cumulative distribution function]{.defword title=\"A **cumulative distribution function** is a mathematical expression that gives the probability that a random variable will equal a particular element of the variable's sample space or less.\"} tells us where a sample space element ranks in a distribution. Whereas the probability mass function tells us the probability that a random variable will generate a particular number, the cumulative distribution function tells us the probability that a random variable will generate a particular number or less. \n\n$$\nF_X(x) = P(X \\le x)=p\n$$\n\n\n\n\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![The cumulative distribution function of the roll of a die is $F_X(x)=\\frac{x}{6}$](distributions_files/figure-html/fig-cdfDie-1.png){#fig-cdfDie fig-align='left' width=90%}\n:::\n:::\n\n\n\n\n\n\nThe cumulative distribution function of the roll of a die (@fig-cdfDie) tells us that the probability of rolling at least a 4 is 4&frasl;6 (i.e., &frac23;).\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-cdfDie\n\n```{.r .cell-code}\nr <- 1.85\nspace <- 1.4\n\nmake_e_center <- \\(x0,y0, r, space) {\n    cc <- \"black\"\n    if (y0 <= x0) cc <- cc <- \"#4169e1\"\n    x0 <- x0 * (2 * r + space)\n    y0 <- y0 * (2 * r + space)\np <- tibble(x = x0, y = y0) %>% \n  select(x,y) %>% \n  ob_point()\np %>% set_props(color = cc)\n  }\n\ne_center <- crossing(x0 = 1:6, y0 = 1:6, r = r, space = space) %>% \n  pmap(make_e_center) %>% \n  bind()\n\n\n\np_center <- crossing(x0 = 1:6, y0 = 1:6, r = r, space = space) %>% \n  pmap(\\(x0,y0, r, space) {\n    cc <- \"black\"\n    if (y0 <= x0) cc <- \"#4169e1\"\n    i = y0\n    x0 <- x0 * (2 * r + space)\n    y0 <- y0 * (2 * r + space)\n    p <- makedice(i,i, F) %>% \n      mutate(y = y + y0 ,\n             x = x + x0) %>% \n      select(x,y) %>% \n      ob_point()\n    p %>% set_props(color = cc)\n  }) %>% \n  bind()\n\n# shape list\nggdiagram(bfont) +\n  ob_circle(p_center,\n            radius = .35,\n            fill = p_center@color,\n            color = NA) +\n  ob_ellipse(e_center, a = r, b = r, m1 = 12) +\n  geom_path(\n    mapping = aes(x, y),\n    data = tibble(\n      x0 = c(rep(1:6, each = 2)[-12], 6, 6, 1),\n      y0 = c(rep(1:6, each = 2)[-1], 6, 1, 1),\n      r = r,\n      space = space,\n      corner = c(rep(c(\n        \"northwest\", \"southeast\"\n      ), 5), \"northwest\", \"northeast\", \"southeast\", \"southwest\"),\n      revsort = c(rep(c(-1, 1), 5), -1, -1, -1, -1)\n    ) %>%\n      pmap_df(\\(x0, y0, r, space, corner, revsort) {\n        p <- make_e_center(x0, y0, r, space)\n        l <- c(\n          northeast = 0,\n          northwest = 90,\n          southwest = 180,\n          southeast = 270\n        )\n        h <- c(\n          northeast = 90,\n          northwest = 180,\n          southwest = 270,\n          southeast = 360\n        )\n        e <- ob_ellipse(p,\n                        a = r + space / 2,\n                        b = r + space / 2,\n                        m1 = 12)\n        e@polygon %>%\n          dplyr::mutate(diagonal = x0 == y0) %>%\n          dplyr::filter((diagonal &\n                           dplyr::between(degree, l[corner], h[corner])) |\n                          (!diagonal & dplyr::between(degree, 270, 360))) %>%\n          dplyr::mutate(new_degree = revsort * degree) %>%\n          dplyr::arrange(new_degree)\n      }),\n    color = myfills[2],\n    linewidth = 1\n  ) + \n  {x_label <- ob_label(\n    1:6,\n    p = purrr::pmap(tibble(\n      x0 = 1:6,\n      y0 = 1,\n      r = r,\n      space = space\n    ), make_e_center) %>% bind() + ob_point(0, -4),\n    color = \"black\",\n    size = 20\n  )} + \n  {y_label <- ob_label(\n    paste0(1:6, \"&frasl;6\"),\n    p = purrr::pmap(tibble(\n      y0 = 1:6,\n      x0 = 1,\n      r = r,\n      space = space\n    ), make_e_center) %>% bind() + ob_point(-4, 0),\n    color = \"black\",\n    size = 24\n  )} +\n  (x_label@p@bounding_box@south + ob_point(0, -2))@label(\n    \"Die roll is this value or less\", \n    size = 24) +\n  (y_label@p@bounding_box@west + ob_point(-2,0))@label(\n    \"Probability\", \n    size = 24, \n    angle = 90)\n```\n\n\n:::\n:::\n\n\n\n\nThe cumulative distribution function is often distinguished from the probability mass function with a capital $F$ instead of a lowercase $f$. In the case of a discrete uniform distribution consisting of $n$ consecutive integers from $a$ to $b$, the cumulative distribution function is:\n\n$$\n\\begin{align*}\nF_X(x;a,b)=\\frac{x-a+1}{b-a+1}\\\\[2ex]\n=\\frac{x-a+1}{n}\n\\end{align*}\n$$\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|Symbol |Meaning                                                |\n|:------|:------------------------------------------------------|\n|$X$    |A random variable with a discrete uniform distribution |\n|$F_X$  |The cumulative distribution function of $X$            |\n|$x$    |Any particular member of the sample space of $X$       |\n|$a$    |The lower bound of the sample space                    |\n|$b$    |The upper bound of the sample space                    |\n|$n$    |$b-a+1$ (The number of points in the sample space)     |\n\n\n:::\n:::\n\n\n\n\n\nIn the case of the the six-sided die, the cumulative distribution function is \n\n$$\n\\begin{aligned}\nF_X(x;a=1,b=6)&=\\frac{x-a+1}{b-a+1}\\\\[2ex]\n&=\\frac{x-1+1}{6-1+1}\\\\[2ex]\n&=\\frac{x}{6}\n\\end{aligned}\n$$\n\nThe cumulative distribution function is so-named because it adds all the probabilities in the probability mass function up to and including a particular member of the sample space. @fig-pmf2cdf shows how the each probability in the cumulative distribution function of the roll of a six-sided die is the sum of the current and all previous probabilities in the probability mass function.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![The cumulative distribution function is the sum of the current and all previous elements of the probability mass function.](images/pmf2cdf.gif){#fig-pmf2cdf fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-pmf2cdf\n\n```{.r .cell-code}\n# The cumulative distribution function is the sum of the current \n# and all previous elements of the probability mass function\np <- crossing(id = 1:6,\n         x = 1:6) %>% \n  mutate(pmf = 1 / 6) %>% \n  mutate(cdf = ifelse(id < x, 1 / 6, x / 6)) %>% \n  ggplot(aes(x = x, y = cdf)) + \n  geom_segment(aes(yend = cdf - pmf, xend = x), \n               color = myfills[2]) + \n  geom_segment(aes(y = 0, yend = pmf, xend = x), \n               color = myfills[1]) + \n  geom_line(aes(y = pmf), lty = \"dotted\", color = myfills[1]) +\n  geom_line(data = . %>% dplyr::filter(x <= id), \n            lty = \"dotted\", \n            color = myfills[2] ) +\n  geom_point(aes(y = pmf),\n             color = myfills[1],\n             size = 5) +\n  geom_point(data = . %>% dplyr::filter(x <= id), \n             color = myfills[2],\n             size = 3.5) +\n  scale_x_continuous(\"Sample Space\", \n                     breaks = 1:6,\n                     expand = c(0.03,0),\n                     minor_breaks = NULL) +\n  scale_y_continuous(\"Probability\",\n                     breaks = 0:6 / 6, \n                     labels = c(0, paste0(1:5, \"/\", 6),1),\n                     expand = c(0.03,0),\n                     minor_breaks = NULL) +\n  theme_minimal(base_size = 18, base_family = bfont) +\n  coord_fixed(6) + \n  annotate(\"point\",\n           size = 5, \n           x = 1.2,  \n           y = 5.33 / 6, \n           color = myfills[1]) + \n  annotate(\"point\",\n           size = 3.5, \n           x = 1.2,  \n           y = 5.66 / 6, \n           color = myfills[2])  + \n  annotate(\"label\",\n           size = 6, \n           x = 1.33,  \n           y = 5.33 / 6, \n           color = myfills[1],\n           label = \"Probability Mass Function\",\n           hjust = 0,\n           family = bfont, \n           label.padding = unit(0, \"lines\"), \n           label.size = 0\n           ) + \n  annotate(\"label\",\n           size = 6, \n           x = 1.33,  \n           y = 5.66 / 6, \n           color = myfills[2],\n           label = \"Cumulative Distribution Function\",\n           hjust = 0,\n           family = bfont, \n           label.padding = unit(0, \"lines\"), \n           label.size = 0) +\n  transition_states(id,2,1) +\n  ease_aes(\"sine-in-out\")\n\nanimate(p, \n        device = \"svg\",\n        renderer = magick_renderer(), \n        width = 8,\n        height = 8)\n```\n\n\n:::\n:::\n\n\n\n\n### Quantile functions\n\nThe inverse of the cumulative distribution function is the [quantile function]{.defword title=\"A **quantile function** tells us which value in the sample space of a random variable is greater than a particular proportion of the values the random variable generates.\"}. The cumulative distribution starts with a value $x$ in the sample space and tells us $p$, the proportion of values in that distribution that are less than or equal to $x$. A quantile function starts with a proportion $p$ and tells us the value $x$ that splits the distribution such that the proportion $p$ of the distribution is less than or equal to $x$. \n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![The quantile function is the inverse of the cumulative distribution function: Just flip the X and Y axes!](distributions_files/figure-html/fig-cdfvquantile-1.png){#fig-cdfvquantile fig-align='center' width=100%}\n:::\n:::\n\n\n\n\nAs seen in @fig-cdfvquantile, if you see a graph of a continuous distribution function, just flip the $X$ and $Y$ axes, and you have a graph of a quantile function.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-cdfvquantile\n\n```{.r .cell-code}\n# The quantile function is the inverse of the cumulative distribution function\n\nd <- tibble(x = seq(-4, 4, 0.01)) %>%\n  mutate(p = pnorm(x))\n\np1 <- ggplot(d, aes(x, p)) +\n  geom_arrow(\n    arrow_head = my_arrowhead,\n    arrow_fins = my_arrowhead,\n    color = myfills[1],\n    lwd = 1\n  ) +\n  scale_x_continuous(\"Sample Space (*x*)\", labels = \\(x) signs::signs(x, accuracy = 1)) +\n  scale_y_continuous(paste0(\"Proportion (\",whitespace(10),\"*p*\",whitespace(6),\")\"), labels = prob_label) +\n  theme_minimal(base_size = 26, base_family = bfont) +\n  coord_fixed(8) +\n  annotate(\n    \"richtext\",\n    x = -2,\n    y = .5 + .25 / 4,\n    label = paste0(\"*X* ~ \",\n                   span_style(\"N\", style = \"font-family:'Lucida Calligraphy'\"),\n                   whitespace(12),\n                   \"(0, 1<sup>2</sup>\",whitespace(8),\")\"),\n    family = bfont,\n    label.size = 0,\n    label.padding = unit(0, \"mm\"),\n    size = ggtext_size(26)\n  ) +\n  ggtitle(paste0(\"Cumulative Distribution Function *F<sub>X\",whitespace(8),\"</sub>*(*x*) = *p*\")) +\n  theme(\n    plot.title = ggtext::element_markdown(size = 26 * 0.8), \n    plot.title.position = \"plot\",\n    axis.title.x = ggtext::element_markdown(),\n    axis.title.y = ggtext::element_markdown(),\n    axis.text.x = element_text(hjust = c(0.7, 0.7, 0.5, 0.5, 0.5))\n  )\n\np2 <- ggplot(d, aes(p, x)) +\n  geom_arrow(\n    arrow_head = my_arrowhead,\n    arrow_fins = my_arrowhead,\n    color = myfills[1],\n    lwd = 1\n  ) +\n  scale_y_continuous(\"Sample Space (*x*)\", labels = \\(x) signs::signs(x, accuracy = 1)) +\n  scale_x_continuous(paste0(\"Proportion (\",whitespace(16),\"*p*\",whitespace(4),\")\"), labels = prob_label) +\n  theme_minimal(base_size = 26, base_family = bfont) +\n  coord_fixed(1 / 8) +\n  annotate(\n    \"richtext\",\n    y = 0.5,\n    x = .25,\n    label = paste0(\"*X* ~ \",\n                   span_style(\"N\", style = \"font-family:'Lucida Calligraphy'\"),\n                   whitespace(12),\n                   \"(0, 1<sup>2</sup>\",whitespace(8),\")\"),\n    family = bfont,\n    label.size = 0,\n    label.padding = unit(0, \"mm\"),\n    size = ggtext_size(26)\n  ) +\n  ggtitle(paste0(\"Quantile Function *Q*\",whitespace(2),\"<sub>*X*\",whitespace(8),\"</sub>(\",whitespace(12),\"*p*\",whitespace(8),\") = *x*\")) +\n  theme(plot.title = ggtext::element_markdown(size = 26 * 0.8), \n        plot.title.position = \"plot\",\n        axis.title.x = ggtext::element_markdown(),\n        axis.title.y = ggtext::element_markdown())\n\np1 + p2\n```\n\n\n:::\n:::\n\n\n\n\n\n\n### Generating a Random Sample in R\n\nIn R, the `sample` function generates numbers from the discrete uniform distribution. \n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(1)\n# n = the sample size\nn <- 6000\n# a = the lower bound\na <- 1\n# b = the upper bound\nb <- 6\n# The sample space is the sequence of integers from a to b\nsample_space <- seq(a, b)\n# X = the sample with a discrete uniform distribution\n# The sample function selects n values\n# from the sample space with replacement at random\nX <- sample(sample_space, \n            size = n, \n            replace = TRUE)\n```\n:::\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![Frequency distribution of a discrete uniform random variable from 1 to 6 (*n* = 6,000)](distributions_files/figure-html/fig-discreteplot-1.png){#fig-discreteplot fig-align='left' width=400}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-discreteplot\n\n```{.r .cell-code}\n# Frequency distribution of a discrete uniform random variable from 1 to 6 \ntibble(X = factor(X)) %>% \n  group_by(X) %>% \n  summarise(Frequency = n()) %>% \n  ggplot(aes(X,Frequency, fill = X)) + \n  geom_col(width = 0.7, fill = myfills[1]) + \n  geom_label(aes(label = Frequency), \n             vjust = -0.3, \n             label.size = 0,\n             label.padding = unit(0,\"mm\"), \n             family = bfont,\n             size = 8,\n             color = \"gray30\",\n             fill = \"white\") + \n  theme_minimal(base_size = 28, \n                base_family = bfont) + \n  scale_y_continuous(\"Count\", \n                     expand = expansion(c(0,0.075)), \n                     breaks = seq(0,1000,200)) + \n  scale_x_discrete(NULL) +\n  theme(panel.grid.major.x = element_blank(), \n        legend.position = \"none\") \n```\n\n\n:::\n:::\n\n\n\n\nThe frequencies of the random sample can be seen in @fig-discreteplot. Because of [sampling error]{.defword title=\"Samples imperfectly represent the population from which they are drawn. **Sampling error** refers to differences between sample statistics and population parameters.\"}, the frequencies are approximately the same, but not exactly the same. If the sample is larger, the sampling error is smaller, meaning that the sample's characteristics will tend to more closely resemble the population characteristics. In this case, a larger sample size will produce frequency counts that will appear more even in their magnitude. However, as long as the sample is smaller than the population, sampling error will always be present. With random distributions, the population is assumed to be infinitely large, and thus sampling error at best becomes negligibly small.\n\n\n### Bernoulli Distributions {#sec:BernoulliDist}\n\n\n\n\n::: {#tbl-bernoullifeatures .cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" tbl-cap='Features of Bernoulli Distributions<br>**Notation note:** Whereas $\\{a,b\\}$ is the set of just two numbers, $a$ and $b$, $[a,b]$ is the set of all real numbers between $a$ and $b$.' tbl-colwidths='[50,50]'}\n::: {.cell-output-display}\n\n\n|Feature                          |Symbol                                |\n|:--------------------------------|:-------------------------------------|\n|Sample Space:                    |$x \\in \\{0,1\\}$                       |\n|Probability that $x=1$           |$p \\in {[0,1]}$                       |\n|Probability that $x=0$           |$q = 1 - p$                           |\n|Mean                             |$\\mu = p$                             |\n|Variance                         |$\\sigma^2 = pq$                       |\n|Skewness                         |$\\gamma_1 = \\frac{1 - 2p}{\\sqrt{pq}}$ |\n|Kurtosis                         |$\\gamma_2 = \\frac{1}{pq} - 6$         |\n|Probability Mass Function        |$f_X(x;p) = p^xq^{1 - x}$             |\n|Cumulative Distribution Function |$F_X(x;p) = x+p(1 - x)$               |\n\n\n:::\n:::\n\n\n\n\n\nThe toss of a single coin has the simplest probability distribution that I can think of---there are only two outcomes and each outcome is equally probable (@fig-coin). This is a special case of the [Bernoulli distribution]{.defword title=\"In the **Bernoulli distribution**, there are only two outcomes: a &ldquo;success&rdquo; (1) and a &ldquo;failure&rdquo; (0). If a success has a probability $p$ then a failure has a probability of $q = 1 - p$.\"}. Jakob Bernoulli (@fig-bernoullipic) was a famous mathematician from a famous family of mathematicians. The Bernoulli distribution is just one of the ideas that made Jakob and the other Bernoullis famous. \n\n\n\n\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![The probability distribution of a coin toss](distributions_files/figure-html/fig-coin-1.png){#fig-coin fig-align='left' width=300}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-coin\n\n```{.r .cell-code}\nggdiagram(bfont) +\n  ggimage::geom_image(data = tibble(\n    image = paste0(\"images/Quarter\", \n                   c(\"Heads\", \"Tails\"), \n                   \".png\"), \n    x = 0, \n    y = c(2,1)),\n    aes(x,y, image = image), \n    size = .35) +\n  ob_label(c(\"Sample Space\", \"Probability\"), \n           ob_point(c(0,1.35),2.5), \n           size = 24, \n           vjust = 0) +\n  {c1 <- ob_circle(ob_point(x = 0, \n                            y = c(2,1)), \n                   radius = .35, \n                   color = NA, \n                   fill = NA)} +\n  {l1 <- ob_label(\n    \"&frac12;\",\n    ob_point(x = 1.35, \n             y = c(2,1)), \n    size = 36)} +\n  connect(\n    c1,\n    l1@p ,\n    linewidth = 2,\n    resect_fins = 5,\n    resect_head = 10,\n    length_head = 4,\n    color = \"gray70\"\n  ) +\n  scale_x_continuous(NULL, expand = expansion(add = c(.3, .5))) +\n  scale_y_continuous(NULL, expand = expansion(add = c(-.1, .1))) \n```\n\n\n:::\n:::\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![Jakob Bernoulli (1654--1705)<br>[Image Credits](https://en.wikipedia.org/wiki/File:Jakob_Bernoulli.jpg)](images/Jakob_Bernoulli2.jpg){#fig-bernoullipic fig-align='left' width=200}\n:::\n:::\n\n\n\n\nThe Bernoulli distribution can describe any random variable that has two outcomes, one of which has a probability $p$ and the other has a probability $q=1-p$. In the case of a coin flip, $p=0.5$. For other variables with a Bernoulli distribution, $p$ can range from 0 to 1.\n\n\n\nIn psychological assessment, many of the variables we encounter have a Bernoulli distribution. In ability test items in which there is no partial credit, examinees either succeed or fail. The probability of success on an item (in the whole population) is $p$. In other words, $p$ is the proportion of the entire population that correctly answers the question. Some ability test items are very easy and the probability of success is high. In such cases, $p$ is close to 1. When $p$ is close to 0, few people succeed and items are deemed hard. Thus, in the context of ability testing, $p$ is called the [difficulty parameter]{.defword title=\"The **difficulty parameter** is the proportion of people who succeed on an ability item or endorse a yes/no questionnaire item.\"}. This is confusing because when $p$ is high, the item is easy, not difficult. Many people have suggested that it would make more sense to call it the *easiness parameter*, but the idea has never caught on.\n\nTrue/False and Yes/No items on questionnaires also have Bernoulli distributions. If an item is frequently endorsed as true (\"I like ice cream.\"), $p$ is high. If an item is infrequently endorsed (\"I like black licorice and mayonnaise in my ice cream.\"), $p$ is very low. Oddly, the language of ability tests prevails even here. Frequently endorsed questionnaire items are referred to as \"easy\" and infrequently endorsed items are referred to as \"difficult,\" even though there is nothing particularly easy or difficult about answering them either way.\n\n#### Generating a Random Sample from the Bernoulli Distribution\n\n\n\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![Counts of a Random Variable with a Bernoulli Distribution $(p = 0.8, n = 1000)$](distributions_files/figure-html/fig-BernoulliSample-1.png){#fig-BernoulliSample fig-align='left' width=300}\n:::\n:::\n\n\n\n\nIn R, there is no specialized function for the Bernoulli distribution because it turns out that the Bernoulli distribution is a special case of the [binomial distribution](#sec:binomial), which will be described in the next section. With the function `rbinom`, we can generate data with a Bernoulli distribution by setting the `size` parameter equal to 1.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n# n = sample size\nn <- 1000\n# p = probability\np <- 0.8\n# X = sample\nX <- rbinom(n, size = 1, prob = p)\n# Make a basic plot\nbarplot(table(X))\n```\n:::\n\n\n\n\nIn @fig-BernoulliSample, we can see that the random variable generated a sequence that consists of about 80% ones and 20% zeroes. However, because of sampling error, the results are rarely exactly what the population parameter specifies. \n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-BernoulliSample\n\n```{.r .cell-code}\n# Counts of a Random Variable with a Bernoulli Distribution\nset.seed(4)\n# n = sample size\nn <- 1000\n# p = probability\np <- 0.8\n# X = sample\nX <- rbinom(n, size = 1, prob = p)\n# Make a basic plot\nggplot(tibble(X = factor(X)), aes(X)) +\n  geom_bar(fill = myfills[1]) +\n  scale_x_discrete(NULL) + \n  scale_y_continuous(NULL, expand = expansion(c(0.01,0.1))) +\n  geom_text(aes(label = after_stat(count)), \n            stat = \"count\", \n            vjust = -0.4, \n            size = ggtext_size(18),\n            family = bfont,\n            color = \"gray10\") + \n    theme_minimal(18, bfont) + \n  theme(panel.grid.major.x = element_blank())\n```\n\n\n:::\n:::\n\n\n\n\n### Binomial Distributions {#sec:binomial}\n\n\n\n\n::: {#tbl-binomialfeatures .cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" tbl-colwidths='[50,50]' tbl-cap='Features of Binomial Distributions'}\n::: {.cell-output-display}\n\n\n|Feature                              |Symbol                                                       |\n|:------------------------------------|:------------------------------------------------------------|\n|Number of Trials                     |$n \\in \\{1,2,3,\\ldots\\}$                                     |\n|Sample Space                         |$x \\in \\{0,...,n\\}$                                          |\n|Probability of success in each trial |$p \\in [0,1]$                                                |\n|Probability of failure in each trial |$q = 1 - p$                                                  |\n|Mean                                 |$\\mu = np$                                                   |\n|Variance                             |$\\sigma = npq$                                               |\n|Skewness                             |$\\gamma_1 = \\frac{1-2p}{\\sqrt{npq}}$                         |\n|Kurtosis                             |$\\gamma_2 = \\frac{1}{npq} - \\frac{6}{n}$                     |\n|Probability Mass Function            |$f_X(x;n,p)=\\frac{n!}{x!\\left(n-x\\right)!}p^x q^{n-x}$       |\n|Cumulative Distribution Function     |$F_X(x;n,p)=\\sum_{i=0}^{x}{\\frac{n!}{i!(n-i)!} p^i q^{n-i}}$ |\n\n\n:::\n:::\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![Probability distribution of the number of heads observed when two coins are tossed](distributions_files/figure-html/fig-twocoin-1.png){#fig-twocoin fig-align='left' width=75%}\n:::\n:::\n\n\n\n\nLet's extend the idea of coin tosses and see where it leads. Imagine that two coins are tossed at the same time and we count how many heads there are. The outcome we might observe will be zero, one, or two heads. Thus, the sample space for the outcome of the tossing of two coins is the set $\\{0,1,2\\}$ heads. There is only one way that we will observe no heads (both coins tails) and only one way that we will observe two heads (both coins heads). In contrast, as seen in @fig-twocoin, there are two ways that we can observe one head (heads-tails \\& tails-heads).\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-twocoin\n\n```{.r .cell-code}\nh <- dbinom(c(0,1,2), 2, .5)\nnudged <- c(.7, .3)\ntibble(x = c(0,1,2),\n       y = dbinom(x, 2, .5)) %>%\n  # mutate(x = factor(x)) %>% \nggplot(aes(x,y)) +\n  ob_rectangle(ob_point(c(0,1,2) , h / 2), \n               height = h, \n               width = .96, \n               corner_radius = unit(5,\"pt\"), \n               fill = myfills[1], \n               color = NA) +\n  ggimage::geom_image(aes(x,y, image = i), \n                      data = tibble(x = c(0,0,1,1,1,1,2,2),\n                                    y = c(.25 * nudged, .25 * nudged, .25 + .25 * nudged, .25 * nudged),\n                                    i = paste0(\"images/Quarter\",\n                                               c(\"Heads\", \"Tails\"), \n                                               \".png\")[c(2,2,2,1,1,2,1,1)]),\n                      size = .25) +\n  theme_minimal(base_size = 32, base_family = bfont) +\n  theme(panel.grid = element_blank(), axis.line.y = element_line(\"gray40\", linewidth = .5), axis.ticks = element_line(\"gray40\", linewidth = .5)) + \n  scale_x_continuous(\"Number of Heads\") +\n  scale_y_continuous(NULL, breaks = c(0,.25, .5), labels = WJSmisc::prob_label, expand = expansion(mult = c(0,.01)))\n```\n\n\n:::\n:::\n\n\n\n\n\nThe probability distribution of the number of heads observed when two coins are tossed at the same time is a member of the *binomial distribution* family. The binomial distribution occurs when [independent]{.defword title=\"Two random variable are said to be **independent** if the outcome of one variable does not alter the probability of any outcome in the other variable.\"} random variables with the same [Bernoulli distribution](#sec:BernoulliDist) are added together. In fact, Bernoulli discovered the binomial distribution as well as the Bernoulli distribution.\n\nImagine that a die is rolled 10 times and we count how often a 6 occurs.^[Wait! Hold on! I thought that throwing dice resulted in a (discrete) *uniform* distribution. Well, it still does. However, now we are asking a different question. We are only concerned with two outcomes each time the die is thrown: 6 and not 6. This is a Bernoulli distribution, not a uniform distribution, because the probability of the two events is unequal: {&frac16;,&frac56;}] Each roll of the die is called a [trial]{.defword title=\"Every time a random variable generates a number, that instance of the variable is called a **trial**, which is also known as an **experiment**.\"}. The sample space of this random variable is $\\{0,1,2,...,10\\}$. What is the probability that a 6 will occur 5 times? or 1 time? or not at all? Such questions are answered by the binomial distribution's [probability mass function](#sec:pmf):\n\n\n$$\nf_X(x;n,p)=\\frac{n!}{x!\\left(n-x\\right)!}p^x\\left(1-p\\right)^{n-x}\n$$\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|Symbol |Meaning                                                                                    |\n|:------|:------------------------------------------------------------------------------------------|\n|$X$    |The random variable (the number of sixes from 10 throws of the die)                        |\n|$x$    |Any particular member of the sample space (i.e., $x \\in \\{0,1,2,...,10\\}$)                 |\n|$n$    |The number of times that the die is thrown (i.e., $n=10$)                                  |\n|$p$    |The probability that a six will occur on a single throw of the die (i.e., $p=\\frac{1}{6}$) |\n\n\n:::\n:::\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![The probability distribution of the number of sixes observed when a six-sided die is thrown 10 times.](distributions_files/figure-html/fig-pmf6-1.png){#fig-pmf6 fig-align='left' width=350}\n:::\n:::\n\n\n\n\n\nBecause $n=10$ and $p=\\frac{1}{6}$, the probability mass function simplifies to:\n\n\\begin{equation*}\nf_X(x)=\\frac{n!}{x!\\left(n-x\\right)!}\\left(\\frac{1}{6}\\right)^x\\left(\\frac{5}{6}\\right)^{10-x}\n\\end{equation*}\n\n\nIf we take each element $x$ of the sample space from 0 to 10 and plug it into the equation above, the probability distribution will look like @fig-pmf6.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code\n\n```{.r .cell-code}\n# Probability of sixes\n\ntibble(sample_space = 0:10) %>% \n  mutate(\n    probability = dbinom(\n      sample_space, \n      size = max(sample_space), \n      prob = 1 / 6),\n    probabiltiy_label = prob_label(probability, \n                                   digits = 2)) %>% \n  ggplot(aes(factor(sample_space), probability)) +\n  geom_col(fill = myfills[1]) + \n  ggtext::geom_richtext(\n    aes(label = probabiltiy_label),\n    size = ggtext_size(30),\n    angle = 90, \n    hjust = 0,\n    family = bfont, \n    label.margin = unit(c(0,0,0,1), \"mm\"),\n    label.padding = unit(c(1.6,0,0,0),\"mm\"), \n    label.colour = NA,\n    color = \"gray40\") +\n  theme_minimal(base_family = bfont, base_size = 30) + \n  scale_y_continuous(\"Probability\", \n                     expand = expansion(c(0,.09)), \n                     labels = prob_label) + \n  scale_x_discrete(\"Sample Space (Number of Sixes)\") + \n  theme(panel.grid.major.x = element_blank()) \n```\n\n\n:::\n:::\n\n\n\n\n#### Clinical Applications of the Binomial Distribution \n\nWhen would a binomial distribution be used by a clinician? One particularly important use of the binomial distribution is in the detection of [malingering]{.defword title=\"A person who **malingers** is pretending to be sick to avoid work or some other responsibility.\"}. Sometimes people pretend to have memory loss or attention problems in order to win a lawsuit or collect insurance benefits. There are a number of ways to detect malingering but a common method is to give a very easy test of memory in which the person has at least a 50\\% chance of getting each test item correct even if the person guesses randomly. \n\nSuppose that there are 20 questions. Even if a person has the worst memory possible, that person is likely to get about half the questions correct. However, it is possible for someone with a legitimate memory problem to guess randomly and by bad luck answer fewer than half of the questions correctly. Suppose that a person gets 4 questions correct. How likely is it that a person would, by random guessing, only answer 4 or fewer questions correctly?\n\nWe can use the binomial distribution's cumulative distribution function. However, doing so by hand is rather tedious. Using R, the answer is found with the `pbinom` function:\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\np <- pbinom(4,20,0.5)\n```\n:::\n\n\n\n\nWe can see that the probability of randomly guessing and getting 4 or fewer items correct out of 20 items total is approximately 0.006, which is so low that the hypothesis that the person is malingering seems plausible. Note here that there is a big difference between these two questions:\n\n* If the person is guessing at random (i.e., not malingering), what is the probability of answering correctly 4 questions or fewer out of 20?\n* If the person answers 4 out of 20 questions correctly, what is the probability that the person is guessing at random (and therefore not malingering)?\n\nHere we answer only the first question. It is an important question, but the answer to the second question is probably the one that we really want to know. We will answer it in another chapter when we discuss positive predictive power. For now, we should just remember that the questions are different and that the answers can be quite different.\n\n#### Graphing the binomial distribution\n\nSuppose that there are $n=10$ trials, each of which have a probability of $p=0.8$. The sample space is the sequence of integers from 0 to 10, which can be generated with the `seq` function (i.e., `seq(0,10)`) or with the colon operator `0:10`.  First, the sample space is generated (a sequence from 0 to 10.), using the `seq` function. The associated probability mass function probabilities are found using the `dbinom` function. The cumulative distribution function probabilities are found using the `pbinom` function.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n# Make a sequence of numbers from 0 to 10\nSampleSpace <- seq(0, 10)\n# Probability mass distribution for \n# binomial distribution (n = 10, p = 0.8)\npmfBinomial <- dbinom(SampleSpace, \n                      size = 10, \n                      prob = 0.8)\n# Generate a basic plot of the \n# probability mass distribution\nplot(pmfBinomial ~ SampleSpace, \n     type = \"b\")\n# Cumulative distribution function \n# for binomial distribution (n = 10, p = 0.8)\ncdfBinomial <- pbinom(SampleSpace, \n                      size = 10, \n                      prob = 0.8)\n```\n\n::: {.cell-output-display}\n![Basic plot of a binomial probability mass function](distributions_files/figure-html/fig-binomGraphSimple-1.png){#fig-binomGraphSimple fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n# Cumulative distribution function \n# for binomial distribution (n = 10, p = 0.8)\ncdfBinomial <- pbinom(SampleSpace, \n                      size = 10, \n                      prob = 0.8)\n# Generate a basic plot of the\n# binomial cumulative distribution function\nplot(cdfBinomial ~ SampleSpace, \n     type = \"b\")\n```\n\n::: {.cell-output-display}\n![Basic plot of a binomial cumulative distribution function](distributions_files/figure-html/fig-binomGraphSimplecdf-1.png){#fig-binomGraphSimplecdf fig-align='center' width=100%}\n:::\n:::\n\n\n\n\nHowever, making the graph look professional involves quite a bit of code that can look daunting at first. However, the results are often worth the effort. Try running the code below to see the difference. For presentation-worthy graphics, export the graph to the .pdf or .svg format. An .svg file can be imported directly into MS Word or MS PowerPoint. \n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![Probability Mass Function and Cumulative Distribution Function of the Binomial Distribution $(n = 10,~p = 0.8)$](distributions_files/figure-html/fig-BinomialDistribution-1.png){#fig-BinomialDistribution fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-BinomialDistribution\n\n```{.r .cell-code}\n# Probability Mass Function and Cumulative Distribution \n# Function of the Binomial Distribution\ntibble(SampleSpace = 0:10,\n       pmf = dbinom(SampleSpace, 10, 0.8),\n       cdf = pbinom(SampleSpace, 10, 0.8)) %>%\n  pivot_longer(-SampleSpace, \n               names_to = \"Function\", \n               values_to = \"Proportion\") %>% \n  mutate(Function = factor(Function, \n                           levels = c(\"pmf\", \"cdf\")) ) %>%\n  arrange(desc(Function)) %>%\n  ggplot(aes(x = SampleSpace,\n             y = Proportion,\n             color = Function)) +\n  geom_pointline(lty = \"dotted\", distance = unit(3, \"mm\")) +\n  geom_point(aes(size = Function)) +\n  theme_minimal(base_family = \"serif\",\n                base_size = 18) +\n  scale_color_manual(values = myfills) +\n  scale_x_continuous(\"Sample Space\",\n                     breaks = seq(0, 10, 2),\n                     expand = expansion(0.02)) +\n  scale_y_continuous(expand = expansion(0.02),\n                     labels = prob_label) +\n  scale_size_manual(values = c(3, 4.5)) +\n  theme(legend.position = \"none\") +\n  annotate(\n    x = 10 - 0.16,\n    y = dbinom(10, 10, 0.8),\n    geom = \"label\",\n    label = \"Probability Mass Function\",\n    hjust = 1,\n    size = 4.75,\n    color = myfills[1],\n    label.size = 0,\n    family = \"serif\",\n    label.padding = unit(0, \"mm\")\n  ) +\n  annotate(\n    x = 10 - 0.2,\n    y = 1,\n    geom = \"label\",\n    label = \"Cumulative Distribution Function\",\n    hjust = 1,\n    size = 4.75,\n    color = myfills[2],\n    label.size = 0,\n    family = \"serif\",\n    label.padding = unit(0, \"mm\")\n  )\n```\n\n\n:::\n:::\n\n\n\n\n\n### Poisson Distributions\n\n\n\n\n::: {#tbl-PoissonFeatures .cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" tbl-cap='Features of Poisson Distributions<br>**Notation note**: The notation $(0,\\infty)$ means all real numbers greater than 0.' tbl-colwidths='[50,50]'}\n::: {.cell-output-display}\n\n\n|Feature                          |Symbol                                                               |\n|:--------------------------------|:--------------------------------------------------------------------|\n|Parameter                        |$\\lambda \\in (0,\\infty)$                                             |\n|Sample Space                     |$x\\in \\{0,1,2,\\ldots\\}$                                              |\n|Mean                             |$\\mu = \\lambda$                                                      |\n|Variance                         |$\\sigma^2 = \\lambda$                                                 |\n|Skewness                         |$\\gamma_1 = \\frac{1}{\\sqrt{\\lambda}}$                                |\n|Kurtosis                         |$\\gamma_2 = \\frac{1}{\\lambda}$                                       |\n|Probability Mass Function        |$f_X(x;\\lambda) = \\frac{\\lambda^x}{e^{\\lambda} x!}$                  |\n|Cumulative Distribution Function |$F_X(x;\\lambda) =  \\sum_{i=0}^{x}{\\frac{\\lambda^i}{e^{\\lambda} i!}}$ |\n\n\n:::\n:::\n\n::: {.cell .fig-column-margin .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"left\"}\n::: {.cell-output-display}\n![Siméon Denis Poisson (1781--1840)<br>[Image Credits](https://en.wikipedia.org/wiki/File:Simeon_Poisson.jpg)](images/Simeon_Poisson.jpg){#fig-PoissonPortrait fig-align='left' width=250px}\n:::\n:::\n\n\n\n\n\n\nImagine that an event happens sporadically at random and we measure how often it occurs in regular time intervals (e.g., events per hour). Sometimes the event does not occur in the interval, sometimes just once, and sometimes more than once. However, we notice that over many intervals, the average number of events is constant. The distribution of the number of events in each interval will follow a [Poisson distribution]{.defword title=\"The **Poisson distribution** is a discrete distribution used to model how often an event will occur during a particular interval of time.\"}. Although \"Poisson\" means \"fish\" in French, fish have nothing to do with it. This distribution was named after Siméon Denis Poisson, whose work on the distribution made it famous.\n\n\n\nThe Poisson distribution has a single parameter $\\lambda$, the average number of events per time interval. Interestingly, $\\lambda$ is both the mean and the variance of this distribution. The distribution shape will differ depending on how long our interval is. If an event occurs on average 30 times per hour, $\\lambda$ = 30. If we count how often the event occurs in 10-minute intervals, the same event will occur about 5 times per interval, on average (i.e., $\\lambda$ = 1). If we choose to count how often the same event occurs every minute, then $\\lambda$ = 0.5.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![The shape of the Poisson Distribution depends on the interval used for counting events. Here, the event occurs once per minute, on average.](distributions_files/figure-html/fig-samelambda-1.png){#fig-samelambda fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-samelambda\n\n```{.r .cell-code}\n# The shape of the Poisson Distribution\ncrossing(lambda = c(0.5, 5, 30), x = 0:60) %>%\n  mutate(p = dpois(x, lambda)) %>%\n  mutate(lambda = factor(lambda, labels = paste0(\n    \"Every \",\n    c(\"30 Seconds\", \"5 Minutes\", \"Half Hour\"),\n    \" (\\u03BB = \",\n    c(0.5, 5, 30),\n    \")\"\n  ))) %>%\n  ggplot(aes(x, p, color = lambda)) +\n  geom_line(linetype = 3, linewidth = 0.1) +\n  geom_point(size = 2.5, color = \"white\") +\n  geom_point(size = 1) +\n  facet_grid(lambda ~ ., scales = \"free\") +\n  scale_x_continuous(\"Number of Events\", breaks = seq(0, 120, 20)) +\n  scale_color_manual(values = c(myfills[1], \"darkorchid\", myfills[2])) +\n  theme_light(base_size = 20, base_family = bfont) +\n  theme(legend.position = \"none\") +\n  scale_y_continuous(\"Probability\", labels = prob_label)\n```\n\n\n:::\n:::\n\n\n\n\n\n#### A clinical application of the the Poisson distribution\n\nSuppose that you begin treating an adult male client who has panic attacks that come at unpredictable times.  Some weeks there are no panic attacks and some weeks there are many, but on average he has 2 panic attacks each week. The client knows this because he has kept detailed records in a spreadsheet for the last 5 years. The client had sought treatment once before, but terminated early and abruptly because, according to him, \"It wasn't working.\" After sensitive querying, you discover that he expected that treatment should have quickly reduced the frequency of panic attacks to zero. When that did not happen, he became discouraged and stopped the treatment.\n\nBecause your client is well educated and quantitatively inclined, you decide to to use the data he has collected as part of the intervention and also to help set a more realistic set of expectations. Obviously, you and your client both would prefer 0 panic attacks per week, but sometimes it takes more time to get to the final goal. We do not want to terminate treatment that is working just because the final goal has not yet been achieved.\n\nYou plot the frequency of how often he had 0 panic attacks in a week, 1 panic attack in a week, 2 panic attacks in a week, and so forth, as shown in red in @fig-PanicFrequency. Because you have read this book, you immediately recognize that this is a Poisson distribution with $\\lambda$ = 2. When you graph an actual Poison distribution and compare it with your client's data, you see that it is almost a perfect match.^[Note that I am **not** claiming that all clients' panic attack frequencies have this kind of distribution. It just so happens to apply in this instance.] Then you explain that although the goal is permanent cessation of the panic attacks, sometimes an intervention can be considered successful if the frequency of panic attacks is merely reduced. For example, suppose that in the early stages of treatment the frequency of panic attacks were reduced from twice per week to once every other week ($\\lambda$ = 0.5), on average. If such a reduction were achieved, there would still be weeks in which two or more panic attacks occur. According to @fig-PanicCumulativeFrequency, this will occur about 9\\% of the time.\n\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![The variability of a hypothetical client's panic attack frequency before and after treatment](distributions_files/figure-html/fig-PanicFrequency-1.png){#fig-PanicFrequency fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-PanicFrequency\n\n```{.r .cell-code}\n# The variability of a hypothetical \n# client's panic attack frequency\nd_label <- tibble(\n  x = c(0, 2),\n  Time = c(\"After\", \"Before\"),\n  Proportion = dpois(x, lambda = c(0.5, 2)),\n  Label = c(\"After Treatment: \\u03BB = 0.5\",\n            \"Before Treatment: \\u03BB = 2\")\n)\n\ntibble(\n  x = seq(0, 7),\n  Before = dpois(x, lambda = 2),\n  After = dpois(x, lambda = 0.5)\n) %>%\n  gather(key = Time, value = Proportion,-x) %>%\n  ggplot(aes(x, Proportion, color = Time)) +\n  geom_pointline(linetype = \"dotted\", linesize = .5, size = 3, distance = unit(2, \"mm\")) +\n  # geom_point(size = 3) +\n  geom_label(\n    data = d_label,\n    aes(label = Label),\n    hjust = 0,\n    nudge_x = 0.2,\n    family = bfont,\n    label.padding = unit(0, \"lines\"),\n    label.size = 0,\n    size = 6\n  ) +\n  scale_color_manual(values = myfills) +\n  scale_x_continuous(\"Panic Attacks Per Week\",\n                     breaks = 0:7,\n                     minor_breaks = NULL) +\n  scale_y_continuous(labels = . %>% prob_label(., 0.1)) +\n  theme_minimal(base_size = 20, base_family = bfont) +\n  theme(legend.position = \"none\")\n```\n\n\n:::\n:::\n\n\n\n\n\nIn R, you can use the `dpois` function to plot the Poisson probability mass function. For example, if the average number of events per time period is &lambda; = 2, then the probability that there will be 0 events is `dpois(x = 0, lambda = 2)`, which evaluates to 0.1353.\n\nTo calculate the cumulative distribution function of Poisson distribution in R, use the `ppois` function. For example, if we want to estimate the probability of having 4 panic attacks or more in a week if &lambda; = 2, we must subtract the probability of having 3 panic attacks or less from 1, like so:\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n1 - ppois(q = 3, lambda = 2)\n```\n:::\n\n\n\n\n$p = 0.143$\n\nHere is a simple way to plot the probability mass function and the cumulative distribution function using the `dpois` and `ppois` functions:\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n# Make a sequence of integers from 0 to 7\nPanicAttacks <- seq(0, 7)\n\n# Generate the probability mass function with lambda = 2\nProbability <- dpois(PanicAttacks, 2)\n\n# Basic plot of the Poisson \n# distribution's probability mass function\nplot(Probability ~ PanicAttacks, type = \"b\") \n```\n\n::: {.cell-output-display}\n![Poisson Probability Mass Function $(\\lambda=2)$](distributions_files/figure-html/fig-Panicpmf-1.png){#fig-Panicpmf fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n# Generate the cumulative \n# distribution function with lambda = 2\nCumulativeProbability <- ppois(PanicAttacks, 2)\n\n# Basic plot of the Poisson distribution's \n# cumulative distribution function\nplot(CumulativeProbability ~ PanicAttacks, type = \"b\") \n```\n\n::: {.cell-output-display}\n![Poisson Cumulative Distribution Function $(\\lambda=2)$](distributions_files/figure-html/fig-PanicCDF-1.png){#fig-PanicCDF fig-align='center' width=100%}\n:::\n:::\n\n\n\n\nWith an additional series with $\\lambda = 0.5$, the plot can look like @fig-PanicCumulativeFrequency.\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![The cumulative distribution function of a hypothetical client's panic attack frequency before and after treatment](distributions_files/figure-html/fig-PanicCumulativeFrequency-1.png){#fig-PanicCumulativeFrequency fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-PanicCumulativeFrequency\n\n```{.r .cell-code}\n# The cumulative distribution function \n# of a hypothetical client's\n# panic attack frequency before \n# and after treatment\n\nd_label <- tibble(\n  x = c(0, 0),\n  Time = c(\"After\", \"Before\"),\n  Proportion = ppois(x, lambda = c(0.5, 2)),\n  Label = c(\"After Treatment: *&lambda;* = 0.5\",\n            \"Before Treatment: *&lambda;* = 2\")\n)\n\ntibble(\n  x = seq(0, 7),\n  Before = ppois(x, lambda = 2),\n  After = ppois(x, lambda = 0.5)\n) %>%\n  gather(key = Time, value = Proportion,-x) %>%\n  ggplot(aes(x, Proportion, color = Time)) +\n  geom_pointline(linetype = \"dotted\", linesize = .5, size = 3, distance = unit(2, \"mm\")) +\n  geom_richtext(\n    data = d_label,\n    aes(label = Label),\n    hjust = 0,\n    nudge_x = 0.2,\n    family = bfont,\n    label.padding = unit(0, \"lines\"),\n    label.size = 0,\n    size = ggtext_size(20)\n  ) +\n  scale_color_manual(values = myfills) +\n  scale_y_continuous(breaks = seq(0, 1, 0.2), \n                     limits = c(0, 1),\n                     labels = . %>% prob_label(., 0.1)) +\n  scale_x_continuous(\"Panic Attacks Per Week\",\n                     breaks = 0:7,\n                     minor_breaks = NULL) +\n  theme_minimal(base_size = 20, base_family = bfont) +\n  theme(legend.position = \"none\")\n```\n\n\n:::\n:::\n\n\n\n\n### Geometric Distributions\n\n\n\n\n::: {#tbl-GeometricFeatures .cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" tbl-cap='Features of Geometric Distributions' tbl-colwidths='[50,50]'}\n::: {.cell-output-display}\n\n\n|Feature                              |Symbol                              |\n|:------------------------------------|:-----------------------------------|\n|Probability of success in each trial |$p\\in[0,1]$                         |\n|Sample Space                         |$x \\in \\{1,2,3,\\ldots\\}$            |\n|Mean                                 |$\\mu = \\frac{1}{p}$                 |\n|Variance                             |$\\sigma^2 = \\frac{1-p}{p^2}$        |\n|Skewness                             |$\\gamma_1 = \\frac{2-p}{\\sqrt{1-p}}$ |\n|Kurtosis                             |$\\gamma_2 = 6 + \\frac{p^2}{1-p}$    |\n|Probability Mass Function            |$f_X(x;p) = (1-p)^{x-1}p^x$         |\n|Cumulative Distribution Function     |$F_X(x;p) = 1-(1-p)^x$              |\n\n\n:::\n:::\n\n\n\n\nAtul Gawande [-@gawandeBetterSurgeonNotes2007, pp. 219--223] tells a marvelous anecdote about how a doctor used some statistics to help a young patient with cystic fibrosis to return to taking her medication more regularly. Because the story is full of pathos and masterfully told, I will not repeat a clumsy version of it here. However, unlike Gawande, I *will* show how the doctor's statistics were calculated. \n\nAccording to the story, if a patient fails to take medication, the probability that a person with cystic fibrosis will develop a bad lung illness on any particular day is .005. If medication is taken, the risk is .0005. Although these probabilities are both close to zero, over the the course of a year, they result in very different levels of risk. Off medication, the patient has about an 84% chance of getting sick within a year's time. On medication, the patient's risk falls to 17%. As seen in @fig-WithMedicationCDF, the cumulative risk over the course of 10 years is quite different. Without medication, the probability of becoming seriously ill within 10 years at least once is almost certain. With medication, however, a small but substantial percentage (~16%) of patients will go at least 10 years without becoming ill. \n\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n![The cumulative risk of serious lung disease with and without medication](distributions_files/figure-html/fig-WithMedicationCDF-1.png){#fig-WithMedicationCDF fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\" button_before='true' button_after='true' codelabel='R Code'}\n:::{.callout-note collapse=\"true\" appearance=\"minimal\"}\n## R Code for @fig-WithMedicationCDF\n\n```{.r .cell-code}\n# The cumulative risk of serious lung \n# disease with and without medication\n\ntotal_years <- 10\n\ntibble(Days = seq(0, total_years * 365, 10),\n       WithoutMeds = pgeom(Days, 0.005),\n       WithMeds = pgeom(Days, 0.0005)) %>% \n  gather(Meds, p, -Days) %>% \n  mutate(Years = Days / 365) %>% \n  ggplot(aes(Years, p, color = Meds)) + \n  geom_line(linewidth = 1) + \n  theme_minimal(base_size = 18, base_family = bfont) + \n  theme(legend.position = \"none\") +\n  scale_x_continuous(breaks = seq(0,total_years,2)) + \n  scale_y_continuous(\"Cumulative Risk\", breaks = seq(0,1,0.2),\n                     labels = . %>% prob_label(., 0.1)) +\n  scale_color_manual(values = myfills) +\n  coord_fixed(ratio = 10) +\n  annotate(x = 4, y = 0.93, \n           label = \"Without Medication\\nDaily Risk = .005\",\n           geom = \"label\", \n           color = myfills[2],\n           label.padding = unit(0,\"lines\"),\n           label.size = 0,\n           family = bfont,\n           size = 5.2\n           ) +\n  annotate(x = 6.25, y = 0.535, \n           label = \"With Medication\\nDaily Risk = .0005\",\n           geom = \"label\", \n           color = myfills[1],\n           label.padding = unit(0,\"lines\"),\n           label.size = 0,\n           family = bfont,\n           size = 5.2\n           )\n```\n\n\n:::\n:::\n\n\n\n\n\nSuch calculations make use of the *geometric distribution*. Consider a series of [Bernoulli trials](#sec:BernoulliDist) in which an event has a probability $p$ of occurring on any particular trial. The probability mass function of the geometric distribution will tell us the probability that the x^th^ trial will be the first time the event occurs. \n\n$$\nf_X(x;p)=(1-p)^{x-1}p^x\n$$\n\n\n\n\n::: {#tbl-geometric .cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n::: {.cell-output-display}\n\n\n|Symbol |Meaning                                                           |\n|:------|:-----------------------------------------------------------------|\n|$X$    |A random variable with a geometric distribution                   |\n|$f_X$  |The probability mass function of $X$                              |\n|$x$    |The number of Bernoulli trials on which the event first occurs    |\n|$p$    |The probability of an event occurring on a single Bernoulli trial |\n\n\n:::\n:::\n\n\n\n\n\nIn R, the probability mass function of the geometric distribution is calculated with the `dgeom` function:\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n# Make a sequence of integers from 1 to 10\nx <- seq(1, 10)\n\n# Generate the probability mass \n# function with p = 0.6\nProbability <- dgeom(x, prob = 0.6)\n\n# Basic plot of the geometric \n# distribution's probability mass function\nplot(Probability ~ x, type = \"b\") \n```\n\n::: {.cell-output-display}\n![Geometric Probability Mass Function $(p=.6)$](distributions_files/figure-html/fig-GeometricPMF-1.png){#fig-GeometricPMF fig-align='center' width=100%}\n:::\n:::\n\n\n\n\nThe cumulative distribution function of the geometric distribution was used to create @fig-WithMedicationCDF. It tells us the probability that the event will occur on the $x^{th}$ trial or earlier:\n\n$$\nF_X(x;p)=1-(1-p)^x\n$$\n\nIn R, the cumulative distribution function of the geometric distribution uses the `pgeom` function:\n\n\n\n\n::: {.cell .fig-cap-location-margin .tbl-cap-location-margin layout-align=\"center\"}\n\n```{.r .cell-code}\n# Generate the cumulative \n# distribution function with p = 0.6\nCumulativeProbability <- pgeom(x, prob = 0.6)\n\n# Basic plot of the geometric\n# distribution's cumulative distribution function\nplot(CumulativeProbability ~ x, type = \"b\") \n```\n\n::: {.cell-output-display}\n![Geometric Cumulative Distribution Function $(p=.6)$](distributions_files/figure-html/fig-GeometricCDF-1.png){#fig-GeometricCDF fig-align='center' width=100%}\n:::\n:::\n",
    "supporting": [
      "distributions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}